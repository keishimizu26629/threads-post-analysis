# ThreadsæŠ•ç¨¿åˆ†æãƒ„ãƒ¼ãƒ« - æŠ€è¡“ä»•æ§˜æ›¸

## ğŸ“‹ æ¦‚è¦

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå
**ThreadsæŠ•ç¨¿åˆ†æãƒ„ãƒ¼ãƒ« (Threads Post Analysis Tool)**

### ç›®çš„
Threadsï¼ˆMetaï¼‰ã®æŠ•ç¨¿ãƒ‡ãƒ¼ã‚¿ã‚’å®šæœŸçš„ã«åé›†ãƒ»åˆ†æã—ã€ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆæŒ‡æ¨™ã‚’å¯è¦–åŒ–ã™ã‚‹Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³

### å¯¾è±¡ãƒ¦ãƒ¼ã‚¶ãƒ¼
- Threadsã§SNSãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°ã‚’è¡Œã†å€‹äººãƒ»ä¼æ¥­
- æŠ•ç¨¿ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’æ•°å€¤ã§è¿½è·¡ã—ãŸã„ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼

---

## ğŸ—ï¸ ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### å…¨ä½“æ§‹æˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ï¼‰                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚ HTTPS
                 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Frontend: Google Apps Script Web App         â”‚
â”‚    - dashboard.html (UI)                        â”‚
â”‚    - JavaScript (Client-side)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚ google.script.run
                 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Backend: Google Apps Script (TypeScript)     â”‚
â”‚    - Code.ts (Main Entry)                       â”‚
â”‚    - threadsApi.ts (API Communication)          â”‚
â”‚    - dataProcessor.ts (Data Analysis)           â”‚
â”‚    - spreadsheetManager.ts (DB Operations)      â”‚
â”‚    - triggerManager.ts (Batch Jobs)             â”‚
â”‚    - reportGenerator.ts (Report Creation)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚            â”‚            â”‚
    â†“            â†“            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Threads â”‚ â”‚ Props   â”‚ â”‚ Google Sheets   â”‚
â”‚   API   â”‚ â”‚ Service â”‚ â”‚   (Database)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  å¤–éƒ¨API      è¨­å®šä¿å­˜     ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–
```

---

## ğŸ–¥ï¸ Frontendä»•æ§˜ï¼ˆGAS Webã‚¢ãƒ—ãƒªï¼‰

### æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯
- **HTML5**: æ§‹é€ 
- **CSS3**: ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°ï¼ˆMaterial Designé¢¨ï¼‰
- **Vanilla JavaScript**: ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³
- **GAS Client API**: `google.script.run` ã§ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰é–¢æ•°å‘¼ã³å‡ºã—

### ç”»é¢æ§‹æˆ

#### 1. ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚¿ãƒ–
**ç›®çš„**: ç¾åœ¨ã®çŠ¶æ…‹è¡¨ç¤ºã¨ä¸»è¦ã‚¢ã‚¯ã‚·ãƒ§ãƒ³

| è¦ç´  | èª¬æ˜ | æ©Ÿèƒ½ |
|------|------|------|
| ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼æ•°è¡¨ç¤º | æœ€æ–°ã®ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼æ•°ã‚’å¤§ããè¡¨ç¤º | ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å–å¾— |
| åˆ†æå®Ÿè¡Œãƒœã‚¿ãƒ³ | æ‰‹å‹•ã§ãƒãƒƒãƒåˆ†æã‚’å®Ÿè¡Œ | `runAnalysis()` å‘¼ã³å‡ºã— |
| æœ€çµ‚æ›´æ–°æ—¥æ™‚ | æœ€å¾Œã«åˆ†æã—ãŸæ—¥æ™‚ã‚’è¡¨ç¤º | PropertiesServiceã‹ã‚‰å–å¾— |
| ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º | å®Ÿè¡Œä¸­/å®Œäº†/ã‚¨ãƒ©ãƒ¼ã®çŠ¶æ…‹ | éåŒæœŸå‡¦ç†ã®é€²æ— |

#### 2. ãƒ‡ãƒ¼ã‚¿ã‚¿ãƒ–ï¼ˆãƒ¡ã‚¤ãƒ³ãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰
**ç›®çš„**: æŠ•ç¨¿ãƒ‡ãƒ¼ã‚¿ã®ä¸€è¦§è¡¨ç¤º

**ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹æˆ**:

| ã‚«ãƒ©ãƒ å | èª¬æ˜ | ãƒ‡ãƒ¼ã‚¿å‹ | è¡¨ç¤ºå½¢å¼ |
|---------|------|---------|---------|
| æŠ•ç¨¿æ—¥æ™‚ | æŠ•ç¨¿ãŒå…¬é–‹ã•ã‚ŒãŸæ—¥æ™‚ | DateTime | `YYYY-MM-DD HH:mm` |
| æŠ•ç¨¿æ–‡ | æŠ•ç¨¿ã®ãƒ†ã‚­ã‚¹ãƒˆå†…å®¹ | String | æœ€å¤§50æ–‡å­—ï¼ˆä»¥é™ã¯çœç•¥ï¼‰ |
| æ–‡å­—æ•° | æŠ•ç¨¿ã®æ–‡å­—æ•° | Number | æ•´æ•° |
| ã‚¿ã‚¤ãƒ— | æŠ•ç¨¿ã‚¿ã‚¤ãƒ— | String | `TEXT`, `IMAGE`, `VIDEO`, `CAROUSEL` |
| ã„ã„ã­ (12h) | 12æ™‚é–“å¾Œã®ã„ã„ã­æ•° | Number | ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Š |
| ãƒªãƒ—ãƒ©ã‚¤ (12h) | 12æ™‚é–“å¾Œã®ãƒªãƒ—ãƒ©ã‚¤æ•° | Number | ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Š |
| ã‚·ã‚§ã‚¢ (12h) | 12æ™‚é–“å¾Œã®ã‚·ã‚§ã‚¢æ•° | Number | ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Š |
| ã‚¤ãƒ³ãƒ—ãƒ¬ãƒƒã‚·ãƒ§ãƒ³ (12h) | 12æ™‚é–“å¾Œã®ã‚¤ãƒ³ãƒ—ãƒ¬ãƒƒã‚·ãƒ§ãƒ³æ•° | Number | ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Š |
| ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆç‡ | `(ã„ã„ã­+ãƒªãƒ—ãƒ©ã‚¤+ã‚·ã‚§ã‚¢) / ã‚¤ãƒ³ãƒ—ãƒ¬ãƒƒã‚·ãƒ§ãƒ³ Ã— 100` | Number | ãƒ‘ãƒ¼ã‚»ãƒ³ãƒˆï¼ˆå°æ•°ç‚¹1æ¡ï¼‰ |

**æ©Ÿèƒ½**:
- **ã‚½ãƒ¼ãƒˆ**: å„ã‚«ãƒ©ãƒ ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ã‚¯ãƒªãƒƒã‚¯ã§æ˜‡é †/é™é †åˆ‡ã‚Šæ›¿ãˆ
- **ãƒã‚¤ãƒ©ã‚¤ãƒˆ**: å¹³å‡å€¤ã‚’è¶…ãˆã‚‹æ•°å€¤ã‚’ç·‘èƒŒæ™¯ã§å¼·èª¿
- **ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³**: 1ãƒšãƒ¼ã‚¸50ä»¶è¡¨ç¤º
- **æ¤œç´¢**: æŠ•ç¨¿æ–‡ã§çµã‚Šè¾¼ã¿

#### 3. è¨­å®šã‚¿ãƒ–
**ç›®çš„**: APIè¨­å®šã¨ã‚·ã‚¹ãƒ†ãƒ è¨­å®š

| é …ç›® | èª¬æ˜ | ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ |
|------|------|--------------|
| Threads API Key | Threads APIã®ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ | å¿…é ˆã€ç©ºæ–‡å­—ãƒã‚§ãƒƒã‚¯ |
| Threads User ID | åˆ†æå¯¾è±¡ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ID | å¿…é ˆã€æ•°å€¤ã®ã¿ |
| Spreadsheet ID | ãƒ‡ãƒ¼ã‚¿ä¿å­˜å…ˆã®ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆID | å¿…é ˆã€20æ–‡å­—ä»¥ä¸Šã€è‹±æ•°å­—ãƒ»è¨˜å·ã®ã¿ |
| ãƒã‚¤ãƒ©ã‚¤ãƒˆé–¾å€¤ | å¹³å‡å€¤ã®ä½•%ä»¥ä¸Šã‚’å¼·èª¿ã™ã‚‹ã‹ | 0-200%ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ100%ï¼‰ |

**ä¿å­˜ãƒœã‚¿ãƒ³**: å„é …ç›®ã®ä¿å­˜ãƒœã‚¿ãƒ³ã§ `PropertiesService` ã«ä¿å­˜

#### 4. ã‚°ãƒ©ãƒ•ã‚¿ãƒ–ï¼ˆæ™‚ç³»åˆ—å¯è¦–åŒ–ï¼‰
**ç›®çš„**: æŠ•ç¨¿ã”ã¨ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹æ¨ç§»ã‚’æŠ˜ã‚Œç·šã‚°ãƒ©ãƒ•ã§è¡¨ç¤º

**æ©Ÿèƒ½**:
| é …ç›® | èª¬æ˜ |
|------|------|
| æŠ•ç¨¿é¸æŠãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ | è¡¨ç¤ºã™ã‚‹æŠ•ç¨¿ã‚’é¸æŠ |
| ãƒ¡ãƒˆãƒªã‚¯ã‚¹é¸æŠ | ã‚¤ãƒ³ãƒ—ãƒ¬ãƒƒã‚·ãƒ§ãƒ³ã€ã„ã„ã­ã€ã‚³ãƒ¡ãƒ³ãƒˆã€ã‚·ã‚§ã‚¢ã€ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆç‡ã‹ã‚‰é¸æŠ |
| æŠ˜ã‚Œç·šã‚°ãƒ©ãƒ• | Chart.jsã§æ™‚ç³»åˆ—ã‚°ãƒ©ãƒ•ã‚’æç”» |
| ãƒã‚¦ã‚¹ãƒ›ãƒãƒ¼ | å„ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆã§è©³ç´°æƒ…å ±ã‚’è¡¨ç¤ºï¼ˆãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼æ•°ã€çµŒéæ™‚é–“ãªã©ï¼‰ |
| è¤‡æ•°æŠ•ç¨¿æ¯”è¼ƒ | æœ€å¤§5ä»¶ã®æŠ•ç¨¿ã‚’åŒæ™‚è¡¨ç¤º |

**ã‚°ãƒ©ãƒ•ä»•æ§˜**:
- **Xè»¸**: å–å¾—æ™‚åˆ»ï¼ˆ`captured_at`ï¼‰ã¾ãŸã¯æŠ•ç¨¿ã‹ã‚‰ã®çµŒéæ™‚é–“ï¼ˆ`hours_since_post`ï¼‰
- **Yè»¸**: é¸æŠã—ãŸãƒ¡ãƒˆãƒªã‚¯ã‚¹
- **ç·šã®è‰²**: æŠ•ç¨¿ã”ã¨ã«ç•°ãªã‚‹è‰²ï¼ˆè‡ªå‹•å‰²ã‚Šå½“ã¦ï¼‰
- **ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—**: `æŠ•ç¨¿ID: xxx / æ™‚åˆ»: 2024-11-27 15:00 / ã‚¤ãƒ³ãƒ—ãƒ¬ãƒƒã‚·ãƒ§ãƒ³: 1,250 / ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼æ•°: 1,520`

**å®Ÿè£…ä¾‹ï¼ˆChart.jsï¼‰**:
```javascript
async function loadTimeSeriesChart(postId) {
  // ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿å–å¾—
  const data = await google.script.run.withSuccessHandler((result) => {
    renderChart(result);
  }).getMetricsByPostId(postId);
}

function renderChart(metrics) {
  const ctx = document.getElementById('timeSeriesChart').getContext('2d');
  
  const chart = new Chart(ctx, {
    type: 'line',
    data: {
      labels: metrics.map(m => formatDate(m.capturedAt)),
      datasets: [{
        label: 'ã‚¤ãƒ³ãƒ—ãƒ¬ãƒƒã‚·ãƒ§ãƒ³',
        data: metrics.map(m => m.impressions),
        borderColor: 'rgb(75, 192, 192)',
        tension: 0.1,
        fill: false
      }]
    },
    options: {
      responsive: true,
      plugins: {
        tooltip: {
          callbacks: {
            afterBody: (context) => {
              const index = context[0].dataIndex;
              const metric = metrics[index];
              return [
                `ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼æ•°: ${metric.followerCount.toLocaleString()}`,
                `æŠ•ç¨¿ã‹ã‚‰ã®çµŒé: ${metric.hoursSincePost}æ™‚é–“`,
                `ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆç‡: ${metric.engagementRate.toFixed(2)}%`
              ];
            }
          }
        }
      },
      scales: {
        x: {
          title: { display: true, text: 'å–å¾—æ™‚åˆ»' }
        },
        y: {
          title: { display: true, text: 'ã‚¤ãƒ³ãƒ—ãƒ¬ãƒƒã‚·ãƒ§ãƒ³æ•°' },
          beginAtZero: true
        }
      }
    }
  });
}
```

**ãƒ‡ãƒ¼ã‚¿å–å¾—API**:
```javascript
// Webã‚¢ãƒ—ãƒªã®doGet()ã§JSONè¿”å´
function doGet(e) {
  const action = e.parameter.action;
  
  if (action === 'getMetrics') {
    const postId = e.parameter.postId;
    const data = getMetricsByPostId(postId);
    
    return ContentService
      .createTextOutput(JSON.stringify(data))
      .setMimeType(ContentService.MimeType.JSON);
  }
  
  if (action === 'getAllMetrics') {
    const data = getMetricsForLast7Days();
    
    return ContentService
      .createTextOutput(JSON.stringify(data))
      .setMimeType(ContentService.MimeType.JSON);
  }
  
  // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: HTMLã‚¢ãƒ—ãƒªè¡¨ç¤º
  return HtmlService.createHtmlOutputFromFile('dashboard');
}
```

#### 5. ãƒ¬ãƒãƒ¼ãƒˆã‚¿ãƒ–ï¼ˆãƒ—ãƒ¬ãƒŸã‚¢ãƒ ç‰ˆï¼‰
**ç›®çš„**: æœˆæ¬¡ã‚µãƒãƒªãƒ¼ã¨ãƒ©ãƒ³ã‚­ãƒ³ã‚°

| ã‚»ã‚¯ã‚·ãƒ§ãƒ³ | èª¬æ˜ |
|-----------|------|
| æœˆé–“ã‚µãƒãƒªãƒ¼ | æŠ•ç¨¿æ•°ã€å¹³å‡ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆç‡ã€ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼å¢—åŠ æ•° |
| äººæ°—æŠ•ç¨¿Top10 | ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆç‡ãŒé«˜ã„æŠ•ç¨¿ |
| æŠ•ç¨¿æ™‚é–“å¸¯åˆ†æ | æ›œæ—¥ãƒ»æ™‚é–“å¸¯åˆ¥ã®å¹³å‡ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆç‡ |
| ãƒˆãƒ¬ãƒ³ãƒ‰æ¨ç§» | éå»3ãƒ¶æœˆã®æ¨ç§»ã‚°ãƒ©ãƒ• |

---

## ğŸ”§ Backendä»•æ§˜ï¼ˆGoogle Apps Scriptï¼‰

### æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯
- **è¨€èª**: TypeScriptï¼ˆã‚³ãƒ³ãƒ‘ã‚¤ãƒ«â†’JavaScriptï¼‰
- **ãƒ©ãƒ³ã‚¿ã‚¤ãƒ **: Google Apps Script V8
- **ãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ«**: claspï¼ˆGoogleå…¬å¼CLIï¼‰
- **ä¾å­˜é–¢ä¿‚ç®¡ç†**: npmï¼ˆé–‹ç™ºæ™‚ã®ã¿ï¼‰

### ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

```
src/
â”œâ”€â”€ appsscript.json          # GASè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ Code.ts                  # ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆãƒ»doGet/doPost
â”œâ”€â”€ types.ts                 # å‹å®šç¾©
â”œâ”€â”€ dashboard.html           # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
â”œâ”€â”€ threadsApi.ts            # Threads APIé€šä¿¡
â”œâ”€â”€ dataProcessor.ts         # ãƒ‡ãƒ¼ã‚¿åˆ†æãƒ»åŠ å·¥
â”œâ”€â”€ spreadsheetManager.ts    # ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆæ“ä½œ
â”œâ”€â”€ dataManager.ts           # PropertiesServiceç®¡ç†
â”œâ”€â”€ triggerManager.ts        # ãƒˆãƒªã‚¬ãƒ¼ï¼ˆã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¼ï¼‰ç®¡ç†
â”œâ”€â”€ reportGenerator.ts       # ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
â””â”€â”€ gasUtils.ts              # æ±ç”¨ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
```

### ä¸»è¦ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ä»•æ§˜

#### 1. Code.tsï¼ˆã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆï¼‰

**å½¹å‰²**: Webã‚¢ãƒ—ãƒªã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã€å¤–éƒ¨ã‹ã‚‰ã®å‘¼ã³å‡ºã—ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

```typescript
// Webã‚¢ãƒ—ãƒªè¡¨ç¤º
function doGet(e: GoogleAppsScript.Events.DoGet): GoogleAppsScript.HTML.HtmlOutput

// ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆå‡¦ç†
function doPost(e: GoogleAppsScript.Events.DoPost): GoogleAppsScript.Content.TextOutput

// APIè¨­å®šä¿å­˜
function saveApiKey(apiKey: string): { success: boolean; message: string }
function saveUserId(userId: string): { success: boolean; message: string }
function saveSpreadsheetId(spreadsheetId: string): { success: boolean; message: string }

// è¨­å®šå–å¾—
function getApiKey(): string
function getUserId(): string
function getSpreadsheetId(): string | null

// åˆ†æå®Ÿè¡Œ
function runAnalysis(): { success: boolean; message: string; data?: any }
function getLatestData(): any[]
function getFollowerCount(): number
```

#### 2. threadsApi.tsï¼ˆThreads APIé€šä¿¡ï¼‰

**å½¹å‰²**: Threads Graph APIã¨ã®é€šä¿¡

```typescript
class ThreadsApi {
  private apiKey: string;
  private userId: string;
  
  constructor(apiKey: string, userId: string);
  
  // ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾—
  getUserProfile(): {
    id: string;
    username: string;
    followers_count: number;
    profile_picture_url: string;
  }
  
  // æŠ•ç¨¿ä¸€è¦§å–å¾—ï¼ˆãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³å¯¾å¿œï¼‰
  getThreads(limit: number = 100, before?: string): {
    data: Thread[];
    paging?: {
      cursors: {
        before: string;
        after: string;
      };
    };
  }
  
  // æŠ•ç¨¿è©³ç´°å–å¾—ï¼ˆã‚¤ãƒ³ã‚µã‚¤ãƒˆå«ã‚€ï¼‰
  getThreadInsights(threadId: string): {
    id: string;
    text: string;
    timestamp: string;
    media_type: 'TEXT' | 'IMAGE' | 'VIDEO' | 'CAROUSEL';
    likes_count: number;
    replies_count: number;
    reposts_count: number;
    impressions: number;
    engagement_rate: number;
  }
  
  // ãƒ¬ãƒ¼ãƒˆåˆ¶é™å‡¦ç†
  private waitForRateLimit(): void;
  
  // ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
  private handleApiError(error: any): void;
}
```

**APIä»•æ§˜**:
- **ãƒ™ãƒ¼ã‚¹URL**: `https://graph.threads.net/v1.0`
- **èªè¨¼**: Bearerãƒˆãƒ¼ã‚¯ãƒ³ï¼ˆAPIã‚­ãƒ¼ï¼‰
- **ãƒ¬ãƒ¼ãƒˆåˆ¶é™**: 200ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/æ™‚é–“
- **ãƒªãƒˆãƒ©ã‚¤**: 429ã‚¨ãƒ©ãƒ¼æ™‚ã¯60ç§’å¾…æ©Ÿ

#### 3. spreadsheetManager.tsï¼ˆã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆæ“ä½œï¼‰

**å½¹å‰²**: Google Sheetsã‚’ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨ã—ã¦æ“ä½œ

```typescript
class SpreadsheetManager {
  private spreadsheetId: string;
  private sheet: GoogleAppsScript.Spreadsheet.Sheet;
  
  constructor(spreadsheetId: string);
  
  // ã‚·ãƒ¼ãƒˆåˆæœŸåŒ–ï¼ˆãƒ˜ãƒƒãƒ€ãƒ¼ä½œæˆï¼‰
  initializeSheet(sheetName: string): void;
  
  // ãƒ‡ãƒ¼ã‚¿è¿½åŠ ï¼ˆè¡Œå˜ä½ï¼‰
  appendRow(data: any[]): void;
  
  // ãƒ‡ãƒ¼ã‚¿æ›´æ–°ï¼ˆæ—¢å­˜è¡Œï¼‰
  updateRow(rowIndex: number, data: any[]): void;
  
  // ãƒ‡ãƒ¼ã‚¿å–å¾—ï¼ˆå…¨ä»¶ï¼‰
  getAllData(): any[][];
  
  // ãƒ‡ãƒ¼ã‚¿å–å¾—ï¼ˆæ¡ä»¶ä»˜ãï¼‰
  getDataByDate(startDate: Date, endDate: Date): any[][];
  
  // æŠ•ç¨¿IDã§æ¤œç´¢
  findRowByThreadId(threadId: string): number | null;
  
  // ãƒ‡ãƒ¼ã‚¿å‰Šé™¤
  deleteRow(rowIndex: number): void;
  
  // ã‚·ãƒ¼ãƒˆã‚¯ãƒªã‚¢
  clearSheet(keepHeader: boolean = true): void;
  
  // ãƒãƒƒãƒæ›¸ãè¾¼ã¿ï¼ˆé«˜é€ŸåŒ–ï¼‰
  batchWrite(data: any[][]): void;
}
```

**ã‚·ãƒ¼ãƒˆæ§‹æˆ**:

| ã‚·ãƒ¼ãƒˆå | èª¬æ˜ | ã‚«ãƒ©ãƒ  |
|---------|------|--------|
| `posts` | æŠ•ç¨¿ãƒ‡ãƒ¼ã‚¿çµ±åˆãƒ†ãƒ¼ãƒ–ãƒ« | post_id, platform, account_id, posted_at, content, url, char_count, media_type, hashtags, time_category, impressions, likes, comments, shares, follower_count, engagement_rate, captured_at, created_at, updated_at |
| `profile` | ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æƒ…å ± | date, followers_count, username, profile_url |
| `config` | ã‚·ã‚¹ãƒ†ãƒ è¨­å®š | key, value, updated_at |
| `logs` | å®Ÿè¡Œãƒ­ã‚° | timestamp, level, message, error |

#### 4. dataProcessor.tsï¼ˆãƒ‡ãƒ¼ã‚¿åˆ†æãƒ»åŠ å·¥ï¼‰

**å½¹å‰²**: å–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã®åŠ å·¥ãƒ»åˆ†æ

```typescript
class DataProcessor {
  // ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆç‡è¨ˆç®—
  calculateEngagementRate(likes: number, replies: number, shares: number, impressions: number): number;
  
  // å¹³å‡å€¤è¨ˆç®—
  calculateAverages(data: any[]): {
    avgLikes: number;
    avgReplies: number;
    avgShares: number;
    avgEngagementRate: number;
  }
  
  // ãƒã‚¤ãƒ©ã‚¤ãƒˆå¯¾è±¡åˆ¤å®š
  shouldHighlight(value: number, average: number, threshold: number = 1.0): boolean;
  
  // æŠ•ç¨¿ã‚¿ã‚¤ãƒ—åˆ¤å®š
  detectMediaType(text: string, mediaUrl?: string): 'TEXT' | 'IMAGE' | 'VIDEO' | 'CAROUSEL';
  
  // æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆï¼ˆçµµæ–‡å­—å¯¾å¿œï¼‰
  countCharacters(text: string): number;
  
  // æŠ•ç¨¿æ™‚é–“å¸¯åˆ†æ
  analyzePostingTimes(data: any[]): {
    byHour: { [hour: string]: number };
    byDay: { [day: string]: number };
  }
  
  // ãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æ
  analyzeTrend(data: any[], metric: string): {
    trend: 'up' | 'down' | 'stable';
    changeRate: number;
  }
}
```

#### 5. triggerManager.tsï¼ˆãƒˆãƒªã‚¬ãƒ¼ç®¡ç†ï¼‰

**å½¹å‰²**: å®šæœŸå®Ÿè¡Œã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°

```typescript
class TriggerManager {
  // æ—¥æ¬¡ãƒˆãƒªã‚¬ãƒ¼è¨­å®šï¼ˆæ¯æ—¥9:00ï¼‰
  static setupDailyTrigger(functionName: string, hour: number): void;
  
  // é€±æ¬¡ãƒˆãƒªã‚¬ãƒ¼è¨­å®šï¼ˆæœˆæ›œ10:00ï¼‰
  static setupWeeklyTrigger(functionName: string, weekDay: GoogleAppsScript.Script.WeekDay, hour: number): void;
  
  // æœˆæ¬¡ãƒˆãƒªã‚¬ãƒ¼è¨­å®šï¼ˆ1æ—¥10:00ï¼‰
  static setupMonthlyTrigger(functionName: string, dayOfMonth: number, hour: number): void;
  
  // æ—¢å­˜ãƒˆãƒªã‚¬ãƒ¼å‰Šé™¤
  static deleteTrigger(functionName: string): void;
  
  // å…¨ãƒˆãƒªã‚¬ãƒ¼ä¸€è¦§å–å¾—
  static listAllTriggers(): GoogleAppsScript.Script.Trigger[];
  
  // ãƒˆãƒªã‚¬ãƒ¼å‰Šé™¤ï¼ˆå…¨ã¦ï¼‰
  static deleteAllTriggers(): void;
}
```

**ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®š**:
- **æ—¥æ¬¡ãƒãƒƒãƒ**: æ¯æ—¥9:00ã« `runDailyAnalysis()` å®Ÿè¡Œ
- **é€±æ¬¡ãƒ¬ãƒãƒ¼ãƒˆ**: æœˆæ›œ10:00ã« `generateWeeklyReport()` å®Ÿè¡Œ
- **æœˆæ¬¡ãƒ¬ãƒãƒ¼ãƒˆ**: æ¯æœˆ1æ—¥10:00ã« `generateMonthlyReport()` å®Ÿè¡Œ

#### 6. reportGenerator.tsï¼ˆãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆï¼‰

**å½¹å‰²**: åˆ†æãƒ¬ãƒãƒ¼ãƒˆã®ç”Ÿæˆ

```typescript
class ReportGenerator {
  // é€±æ¬¡ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
  generateWeeklyReport(startDate: Date, endDate: Date): {
    totalPosts: number;
    averageEngagement: number;
    topPost: any;
    followerGrowth: number;
  }
  
  // æœˆæ¬¡ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
  generateMonthlyReport(year: number, month: number): {
    totalPosts: number;
    averageEngagement: number;
    topPosts: any[];
    postingTimeAnalysis: any;
    trend: any;
  }
  
  // ãƒ¬ãƒãƒ¼ãƒˆã‚’HTMLã§å‡ºåŠ›
  exportToHtml(report: any): string;
  
  // ãƒ¬ãƒãƒ¼ãƒˆã‚’ãƒ¡ãƒ¼ãƒ«é€ä¿¡
  sendReportEmail(recipient: string, report: any): void;
}
```

#### 7. gasUtils.tsï¼ˆæ±ç”¨ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ï¼‰

```typescript
// PropertiesServiceå®‰å…¨æ“ä½œ
function getPropertySafely(key: string, defaultValue?: string): string;
function setPropertySafely(key: string, value: string): boolean;
function deletePropertySafely(key: string): boolean;

// æ—¥æ™‚æ“ä½œ
function formatDate(date: Date, format: string): string;
function addHours(date: Date, hours: number): Date;
function isWithinTimeRange(date: Date, startDate: Date, endDate: Date): boolean;

// ãƒ­ã‚°å‡ºåŠ›
function logInfo(message: string): void;
function logError(message: string, error: any): void;
function logWarning(message: string): void;

// ãƒ‡ãƒ¼ã‚¿ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
function validateApiKey(apiKey: string): boolean;
function validateSpreadsheetId(id: string): boolean;
function validateUserId(userId: string): boolean;
```

---

## ğŸ—„ï¸ Databaseä»•æ§˜ï¼ˆGoogle Sheetsï¼‰

### ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆæ§‹æˆ

#### ğŸ¯ æ™‚é–“åŒºåˆ†ãƒ™ãƒ¼ã‚¹ã®ãƒ‡ãƒ¼ã‚¿åé›†è¨­è¨ˆæ€æƒ³

ã“ã®ã‚·ã‚¹ãƒ†ãƒ ã§ã¯ã€**æŠ•ç¨¿ã”ã¨ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’æ™‚é–“åŒºåˆ†ï¼ˆ0, 1, 12, 24, 72æ™‚é–“ï¼‰ã§ç®¡ç†**ã™ã‚‹è¨­è¨ˆã‚’æ¡ç”¨ã—ã¦ã„ã¾ã™ã€‚

**è¨­è¨ˆæ–¹é‡**:
- âœ… **1ã¤ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã§ç®¡ç†**: æŠ•ç¨¿æƒ…å ±ã¨ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’çµ±åˆ
- âœ… **æ™‚é–“åŒºåˆ†ã‚«ãƒ©ãƒ ï¼ˆtime_categoryï¼‰**: 
  - `0` = æœ€æ–°ãƒ‡ãƒ¼ã‚¿ï¼ˆå¸¸ã«æ›´æ–°ã•ã‚Œã‚‹ï¼‰
  - `1` = æŠ•ç¨¿1æ™‚é–“å¾Œã®ç¢ºå®šå€¤
  - `12` = æŠ•ç¨¿12æ™‚é–“å¾Œã®ç¢ºå®šå€¤
  - `24` = æŠ•ç¨¿24æ™‚é–“å¾Œã®ç¢ºå®šå€¤
  - `72` = æŠ•ç¨¿72æ™‚é–“å¾Œã®ç¢ºå®šå€¤
- âœ… **åŠ¹ç‡çš„ãªãƒ‡ãƒ¼ã‚¿ç®¡ç†**: 1æŠ•ç¨¿ã«ã¤ãæœ€å¤§5ãƒ¬ã‚³ãƒ¼ãƒ‰
- âœ… **ã‚·ãƒ³ãƒ—ãƒ«ãªæ§‹é€ **: è¤‡æ•°ã‚·ãƒ¼ãƒˆã®JOINãŒä¸è¦
- âœ… **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å¯¾å¿œ**: `time_category=0`ã§æœ€æ–°ãƒ‡ãƒ¼ã‚¿ä¸€è¦§è¡¨ç¤ºã€ç‰¹å®š`post_id`ã§æ™‚ç³»åˆ—ã‚°ãƒ©ãƒ•è¡¨ç¤º

**ãƒ‡ãƒ¼ã‚¿ä¿å­˜æœŸé–“**: éå»7æ—¥åˆ†ï¼ˆè‡ªå‹•å‰Šé™¤ï¼‰

**è¤‡åˆã‚­ãƒ¼**: `post_id` + `time_category` (UNIQUE)

---

#### ã‚·ãƒ¼ãƒˆ: `posts`ï¼ˆæŠ•ç¨¿ãƒ‡ãƒ¼ã‚¿çµ±åˆãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰

**å½¹å‰²**: æŠ•ç¨¿æƒ…å ±ã¨æ™‚ç³»åˆ—ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’1ã¤ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã§ç®¡ç†

| ã‚«ãƒ©ãƒ  | åˆ—å | ãƒ‡ãƒ¼ã‚¿å‹ | èª¬æ˜ | ä¾‹ |
|-------|------|---------|------|-----|
| A | post_id | String | æŠ•ç¨¿IDï¼ˆè¤‡åˆã‚­ãƒ¼ã®ä¸€éƒ¨ï¼‰ | `1234567890123456789` |
| B | content | String | æŠ•ç¨¿æœ¬æ–‡ | `ã“ã‚“ã«ã¡ã¯ï¼ä»Šæ—¥ã¯...` |
| C | posted_at | DateTime | æŠ•ç¨¿æ—¥æ™‚ï¼ˆJSTï¼‰ | `2024-12-11 10:00:00` |
| D | captured_at | DateTime | å–å¾—æ—¥æ™‚ | `2024-12-11 11:00:00` |
| E | likes | Number | ã„ã„ã­æ•° | `45` |
| F | impressions | Number | ã‚¤ãƒ³ãƒ—ãƒ¬ãƒƒã‚·ãƒ§ãƒ³æ•°ï¼ˆviewsï¼‰ | `1250` |
| G | time_category | Number | è¡¨ç¤ºã‚«ãƒ†ã‚´ãƒªï¼ˆè¤‡åˆã‚­ãƒ¼ã®ä¸€éƒ¨ï¼‰<br>0=æœ€æ–°ãƒ‡ãƒ¼ã‚¿, 1/12/24/72=å„æ™‚ç‚¹ã®ç¢ºå®šå€¤ | `0` |
| H | replies | Number | ãƒªãƒ—ãƒ©ã‚¤æ•° | `8` |
| I | reposts | Number | å†æŠ•ç¨¿æ•° | `3` |
| J | quotes | Number | å¼•ç”¨æ•° | `1` |
| K | engagement_rate | String | ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆç‡ï¼ˆ%ï¼‰ | `4.48` |
| L | created_at | DateTime | ãƒ¬ã‚³ãƒ¼ãƒ‰ä½œæˆæ—¥æ™‚ | `2024-12-11 11:00:00` |
| M | updated_at | DateTime | ãƒ¬ã‚³ãƒ¼ãƒ‰æ›´æ–°æ—¥æ™‚ | `2024-12-11 12:00:00` |

**è¤‡åˆã‚­ãƒ¼**: `post_id` + `time_category` (UNIQUE)

**1æŠ•ç¨¿ã‚ãŸã‚Šã®ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°**: æœ€å¤§5ãƒ¬ã‚³ãƒ¼ãƒ‰
- `time_category=0`: æœ€æ–°ãƒ‡ãƒ¼ã‚¿ï¼ˆå¸¸ã«æ›´æ–°ï¼‰
- `time_category=1`: æŠ•ç¨¿1æ™‚é–“å¾Œã®ç¢ºå®šå€¤
- `time_category=12`: æŠ•ç¨¿12æ™‚é–“å¾Œã®ç¢ºå®šå€¤
- `time_category=24`: æŠ•ç¨¿24æ™‚é–“å¾Œã®ç¢ºå®šå€¤
- `time_category=72`: æŠ•ç¨¿72æ™‚é–“å¾Œã®ç¢ºå®šå€¤

**æ™‚é–“åŒºåˆ†ã®å®šç¾©**:
- **0ï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ï¼‰**: æŠ•ç¨¿ç›´å¾Œã€ã¾ãŸã¯1, 12, 24, 72æ™‚é–“ã«è©²å½“ã—ãªã„å ´åˆ
- **1**: æŠ•ç¨¿ã‹ã‚‰1æ™‚é–“çµŒéæ™‚ç‚¹
- **12**: æŠ•ç¨¿ã‹ã‚‰12æ™‚é–“çµŒéæ™‚ç‚¹
- **24**: æŠ•ç¨¿ã‹ã‚‰24æ™‚é–“çµŒéæ™‚ç‚¹
- **72**: æŠ•ç¨¿ã‹ã‚‰72æ™‚é–“çµŒéæ™‚ç‚¹

**ãƒ‡ãƒ¼ã‚¿æ›´æ–°ãƒ­ã‚¸ãƒƒã‚¯**:
1. æŠ•ç¨¿ä¸€è¦§ã‚’å–å¾—ã—ã€å„æŠ•ç¨¿ã®æŠ•ç¨¿æ—¥æ™‚ã‚’ç¢ºèª
2. ç¾åœ¨æ™‚åˆ»ã‹ã‚‰æŠ•ç¨¿æ—¥æ™‚ã‚’å¼•ãã€çµŒéæ™‚é–“ã‚’è¨ˆç®—
3. çµŒéæ™‚é–“ãŒ1, 12, 24, 72æ™‚é–“ã®ã„ãšã‚Œã‹ã«è©²å½“ã™ã‚‹å ´åˆ:
   - è©²å½“ã™ã‚‹æ™‚é–“åŒºåˆ†ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒå­˜åœ¨ã™ã‚‹ã‹ç¢ºèªï¼ˆ`post_id` + `time_category`ï¼‰
   - å­˜åœ¨ã™ã‚‹å ´åˆã¯æ›´æ–°ã€å­˜åœ¨ã—ãªã„å ´åˆã¯æ–°è¦è¿½åŠ 
4. çµŒéæ™‚é–“ãŒ1, 12, 24, 72æ™‚é–“ã«è©²å½“ã—ãªã„å ´åˆ:
   - `time_category = 0` ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’æ›´æ–°ï¼ˆå­˜åœ¨ã—ãªã„å ´åˆã¯è¿½åŠ ï¼‰

**ãƒ‡ãƒ¼ã‚¿è¿½åŠ ã‚¿ã‚¤ãƒŸãƒ³ã‚°**: 
- 1æ™‚é–“ã”ã¨ã®å®šæœŸå®Ÿè¡Œæ™‚ã«æ–°è¦æŠ•ç¨¿ã‚’æ¤œçŸ¥ã—ã€ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’å–å¾—
- æ‰‹å‹•ã§ã€Œåˆ†æå®Ÿè¡Œã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸæ™‚

---

#### ã‚·ãƒ¼ãƒˆ: `account_metrics_hourly`ï¼ˆæ™‚ç³»åˆ—ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ¡ãƒˆãƒªã‚¯ã‚¹ï¼‰â€»ä»»æ„

**å½¹å‰²**: ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå…¨ä½“ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’1æ™‚é–“å˜ä½ã§è¨˜éŒ²

| ã‚«ãƒ©ãƒ  | åˆ—å | ãƒ‡ãƒ¼ã‚¿å‹ | èª¬æ˜ | ä¾‹ |
|-------|------|---------|------|-----|
| A | account_id | String | ã‚¢ã‚«ã‚¦ãƒ³ãƒˆID | `987654321` |
| B | captured_at | DateTime | å–å¾—æ™‚åˆ»ï¼ˆ1æ™‚é–“å˜ä½ï¼‰ | `2024-11-27 15:00:00` |
| C | follower_count | Number | ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼æ•° | `1520` |
| D | total_impressions | Number | 1æ™‚é–“ã§ç™ºç”Ÿã—ãŸåˆè¨ˆã‚¤ãƒ³ãƒ—ãƒ¬ãƒƒã‚·ãƒ§ãƒ³ | `3500` |
| E | profile_views | Number | ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãƒ“ãƒ¥ãƒ¼æ•° | `120` |
| F | total_posts | Number | ç´¯è¨ˆæŠ•ç¨¿æ•° | `450` |

**ã‚­ãƒ¼**: `account_id` + `captured_at`

---

#### ã‚·ãƒ¼ãƒˆ: `profile`ï¼ˆãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æƒ…å ±ï¼‰â€»ãƒ¬ã‚¬ã‚·ãƒ¼

**å½¹å‰²**: æ—¥æ¬¡ã®ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æƒ…å ±ã‚’ä¿å­˜ï¼ˆå¾Œæ–¹äº’æ›æ€§ã®ãŸã‚æ®‹ã™ï¼‰

| ã‚«ãƒ©ãƒ  | åˆ—å | ãƒ‡ãƒ¼ã‚¿å‹ | èª¬æ˜ | ä¾‹ |
|-------|------|---------|------|-----|
| A | date | Date | è¨˜éŒ²æ—¥ | `2024-11-27` |
| B | followers_count | Number | ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼æ•° | `1520` |
| C | username | String | ãƒ¦ãƒ¼ã‚¶ãƒ¼å | `@example` |
| D | profile_url | String | ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«URL | `https://threads.net/@example` |

---

#### ã‚·ãƒ¼ãƒˆ: `config`ï¼ˆã‚·ã‚¹ãƒ†ãƒ è¨­å®šï¼‰

| ã‚«ãƒ©ãƒ  | åˆ—å | ãƒ‡ãƒ¼ã‚¿å‹ | èª¬æ˜ | ä¾‹ |
|-------|------|---------|------|-----|
| A | key | String | è¨­å®šã‚­ãƒ¼ | `last_run_time` |
| B | value | String | è¨­å®šå€¤ | `2024-11-27 15:00:00` |
| C | updated_at | DateTime | æ›´æ–°æ—¥æ™‚ | `2024-11-27 15:00:00` |

**è¨­å®šã‚­ãƒ¼ä¸€è¦§**:
- `last_run_time`: æœ€çµ‚å®Ÿè¡Œæ™‚åˆ»
- `avg_likes`: å¹³å‡ã„ã„ã­æ•°
- `avg_engagement_rate`: å¹³å‡ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆç‡
- `data_retention_days`: ãƒ‡ãƒ¼ã‚¿ä¿å­˜æœŸé–“ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 7æ—¥ï¼‰

---

#### ã‚·ãƒ¼ãƒˆ: `logs`ï¼ˆå®Ÿè¡Œãƒ­ã‚°ï¼‰

| ã‚«ãƒ©ãƒ  | åˆ—å | ãƒ‡ãƒ¼ã‚¿å‹ | èª¬æ˜ | ä¾‹ |
|-------|------|---------|------|-----|
| A | timestamp | DateTime | ãƒ­ã‚°æ—¥æ™‚ | `2024-11-27 15:00:15` |
| B | level | String | ãƒ­ã‚°ãƒ¬ãƒ™ãƒ« | `INFO`, `ERROR`, `WARNING` |
| C | message | String | ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ | `æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿åé›†å®Œäº†: 15ä»¶` |
| D | function_name | String | é–¢æ•°å | `fetchMetricsHourly` |
| E | error | String | ã‚¨ãƒ©ãƒ¼è©³ç´°ï¼ˆã‚ã‚Œã°ï¼‰ | `API rate limit exceeded` |

### ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³

#### 1. æ™‚é–“åŒºåˆ†ãƒ™ãƒ¼ã‚¹ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›†ï¼ˆ1æ™‚é–“ã”ã¨ï¼‰

**å‡¦ç†ãƒ•ãƒ­ãƒ¼**:
```typescript
function fetchMetricsHourly(): { success: boolean; message: string; count: number } {
  try {
    const now = new Date();
    const sheet = SpreadsheetApp.getActive().getSheetByName('posts');
    
    // 1. Threads APIã‹ã‚‰æŠ•ç¨¿ä¸€è¦§ã‚’å–å¾—
    const threads = threadsApi.getThreads(100);
    
    let updatedCount = 0;
    
    // 2. å„æŠ•ç¨¿ã‚’é †ã«ç¢ºèª
    for (const thread of threads.data) {
      const postedAt = new Date(thread.timestamp);
      
      // æŠ•ç¨¿ã‹ã‚‰ã®çµŒéæ™‚é–“ã‚’è¨ˆç®—ï¼ˆæ™‚é–“å˜ä½ï¼‰
      const hoursSincePost = Math.floor(
        (now.getTime() - postedAt.getTime()) / (1000 * 60 * 60)
      );
      
      // æ™‚é–“åŒºåˆ†ã‚’æ±ºå®š
      let timeCategory: number;
      if (hoursSincePost >= 1 && hoursSincePost < 2) {
        timeCategory = 1;
      } else if (hoursSincePost >= 12 && hoursSincePost < 13) {
        timeCategory = 12;
      } else if (hoursSincePost >= 24 && hoursSincePost < 25) {
        timeCategory = 24;
      } else if (hoursSincePost >= 72 && hoursSincePost < 73) {
        timeCategory = 72;
      } else {
        timeCategory = 0; // ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã¾ãŸã¯è©²å½“ã—ãªã„å ´åˆ
      }
      
      // 3. ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’APIå–å¾—
      const insights = threadsApi.getThreadInsights(thread.id);
      
      // 4. æ—¢å­˜ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’æ¤œç´¢ï¼ˆpost_id + time_categoryï¼‰
      const existingRow = findPostRow(sheet, thread.id, timeCategory);
      
      const rowData = [
        thread.id,                                    // post_id
        'threads',                                    // platform
        thread.account_id,                            // account_id
        postedAt,                                     // posted_at
        thread.text,                                  // content
        `https://threads.net/@${thread.username}/post/${thread.id}`, // url
        dataProcessor.countCharacters(thread.text),   // char_count
        thread.media_type,                            // media_type
        extractHashtags(thread.text).join(','),      // hashtags
        timeCategory,                                 // time_category
        insights.impressions,                         // impressions
        insights.likes_count,                         // likes
        insights.replies_count,                       // comments
        insights.reposts_count,                       // shares
        insights.follower_count,                      // follower_count
        dataProcessor.calculateEngagementRate(
          insights.likes_count,
          insights.replies_count,
          insights.reposts_count,
          insights.impressions
        ),                                           // engagement_rate
        now,                                          // captured_at
        existingRow ? null : now,                     // created_atï¼ˆæ—¢å­˜ã®å ´åˆã¯æ›´æ–°ã—ãªã„ï¼‰
        now                                           // updated_at
      ];
      
      if (existingRow === null) {
        // æ–°è¦ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ 
        sheet.appendRow(rowData);
        updatedCount++;
      } else {
        // æ—¢å­˜ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’æ›´æ–°ï¼ˆcreated_atã¯ä¿æŒï¼‰
        const existingCreatedAt = sheet.getRange(existingRow, 18).getValue(); // Råˆ—: created_at
        rowData[17] = existingCreatedAt; // created_atã‚’ä¿æŒ
        sheet.getRange(existingRow, 1, 1, 19).setValues([rowData]);
        updatedCount++;
      }
      
      // ãƒ¬ãƒ¼ãƒˆåˆ¶é™å¯¾ç­–: 18ç§’é–“éš”
      Utilities.sleep(18000);
    }
    
    // 5. 7æ—¥ã‚ˆã‚Šå¤ã„ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤
    deleteOldPosts(sheet, 7);
    
    // 6. ãƒ­ã‚°è¨˜éŒ²
    logInfo(`ãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›†å®Œäº†: ${updatedCount}ä»¶`, 'fetchMetricsHourly');
    
    return { success: true, message: `${updatedCount}ä»¶ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’åé›†ã—ã¾ã—ãŸ`, count: updatedCount };
    
  } catch (error) {
    logError('ãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›†ã‚¨ãƒ©ãƒ¼', error, 'fetchMetricsHourly');
    return { success: false, message: `ã‚¨ãƒ©ãƒ¼: ${error.message}`, count: 0 };
  }
}

// æ—¢å­˜ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’æ¤œç´¢ï¼ˆpost_id + time_categoryï¼‰
function findPostRow(sheet: GoogleAppsScript.Spreadsheet.Sheet, postId: string, timeCategory: number): number | null {
  const values = sheet.getDataRange().getValues();
  
  for (let i = 1; i < values.length; i++) {
    if (values[i][0] === postId && values[i][9] === timeCategory) { // Aåˆ—: post_id, Jåˆ—: time_category
      return i + 1; // 1-based index
    }
  }
  
  return null;
}

// å¤ã„ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤
function deleteOldPosts(sheet: GoogleAppsScript.Spreadsheet.Sheet, retentionDays: number): void {
  const values = sheet.getDataRange().getValues();
  const cutoffDate = new Date();
  cutoffDate.setDate(cutoffDate.getDate() - retentionDays);
  
  // å‰Šé™¤å¯¾è±¡è¡Œã‚’é€†é †ã§å‰Šé™¤ï¼ˆè¡Œç•ªå·ãŒãšã‚Œãªã„ã‚ˆã†ã«ï¼‰
  for (let i = values.length - 1; i >= 1; i--) {
    const postedAt = new Date(values[i][3]); // Dåˆ—: posted_at
    if (postedAt < cutoffDate) {
      sheet.deleteRow(i + 1);
    }
  }
}
```

#### 2. æŠ•ç¨¿ã”ã¨ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹å–å¾—ï¼ˆæ™‚é–“åŒºåˆ†åˆ¥ï¼‰

```typescript
function getMetricsByPostId(postId: string): any[] {
  const sheet = SpreadsheetApp.getActive().getSheetByName('posts');
  const values = sheet.getDataRange().getValues();
  
  const result = [];
  
  for (let i = 1; i < values.length; i++) {
    if (values[i][0] === postId) { // Aåˆ—: post_id
      result.push({
        postId: values[i][0],
        timeCategory: values[i][9],        // Jåˆ—: time_category
        impressions: values[i][10],          // Kåˆ—: impressions
        likes: values[i][11],                // Låˆ—: likes
        comments: values[i][12],             // Måˆ—: comments
        shares: values[i][13],               // Nåˆ—: shares
        followerCount: values[i][14],        // Oåˆ—: follower_count
        engagementRate: values[i][15],       // Påˆ—: engagement_rate
        capturedAt: values[i][16]            // Qåˆ—: captured_at
      });
    }
  }
  
  // æ™‚é–“åŒºåˆ†é †ã«ã‚½ãƒ¼ãƒˆï¼ˆ0, 1, 12, 24, 72ï¼‰
  result.sort((a, b) => a.timeCategory - b.timeCategory);
  
  return result;
}
```

#### 3. ç‰¹å®šæ™‚é–“åŒºåˆ†ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹å–å¾—

```typescript
function getMetricsByTimeCategory(timeCategory: number): any[] {
  const sheet = SpreadsheetApp.getActive().getSheetByName('posts');
  const values = sheet.getDataRange().getValues();
  
  const result = [];
  
  for (let i = 1; i < values.length; i++) {
    if (values[i][9] === timeCategory) { // Jåˆ—: time_category
      result.push({
        postId: values[i][0],
        postedAt: values[i][3],
        content: values[i][4],
        impressions: values[i][10],
        likes: values[i][11],
        comments: values[i][12],
        shares: values[i][13],
        engagementRate: values[i][15]
      });
    }
  }
  
  return result;
}
```

#### 5. æœˆæ¬¡ãƒ¬ãƒãƒ¼ãƒˆç”¨ãƒ‡ãƒ¼ã‚¿å–å¾—

```typescript
// 1. æœŸé–“æŒ‡å®šã§ãƒ‡ãƒ¼ã‚¿å–å¾—
const startDate = new Date(2024, 10, 1); // 2024å¹´11æœˆ1æ—¥
const endDate = new Date(2024, 10, 30); // 2024å¹´11æœˆ30æ—¥
const monthData = spreadsheetManager.getDataByDate(startDate, endDate);

// 2. ãƒ‡ãƒ¼ã‚¿åˆ†æ
const report = reportGenerator.generateMonthlyReport(2024, 11);

// 3. ãƒ¬ãƒãƒ¼ãƒˆä¿å­˜
spreadsheetManager.appendRow([
  'monthly_report',
  JSON.stringify(report),
  new Date()
]);
```

---

## ğŸ” ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä»•æ§˜

### 1. èªè¨¼ãƒ»èªå¯

#### Webã‚¢ãƒ—ãƒªã®ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
- **å®Ÿè¡Œãƒ¦ãƒ¼ã‚¶ãƒ¼**: ã‚¹ã‚¯ãƒªãƒ—ãƒˆæ‰€æœ‰è€…ï¼ˆ`USER_DEPLOYING`ï¼‰
- **ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™**: åŒ¿åã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ï¼ˆ`ANYONE_ANONYMOUS`ï¼‰
- **ç†ç”±**: å€‹äººç”¨ãƒ„ãƒ¼ãƒ«ã®ãŸã‚ã€URLã‚’çŸ¥ã£ã¦ã„ã‚‹äººã®ã¿ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ã§ååˆ†

**å¤‰æ›´æ–¹æ³•**:
```json
// appsscript.json
{
  "webapp": {
    "executeAs": "USER_DEPLOYING",
    "access": "ANYONE_ANONYMOUS"  // ã¾ãŸã¯ "MYSELF"ï¼ˆæœ¬äººã®ã¿ï¼‰
  }
}
```

### 2. APIã‚­ãƒ¼ã®å®‰å…¨ãªä¿ç®¡

#### PropertiesServiceã®ä½¿ç”¨
```typescript
// ä¿å­˜ï¼ˆæš—å·åŒ–ï¼‰
PropertiesService.getScriptProperties().setProperty('THREADS_API_KEY', apiKey);

// å–å¾—
const apiKey = PropertiesService.getScriptProperties().getProperty('THREADS_API_KEY');

// å‰Šé™¤
PropertiesService.getScriptProperties().deleteProperty('THREADS_API_KEY');
```

#### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç‰¹æ€§
- âœ… **ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ä¿å­˜**: Googleã®ã‚µãƒ¼ãƒãƒ¼ã§æš—å·åŒ–
- âœ… **GitHubã«å«ã¾ã‚Œãªã„**: ã‚³ãƒ¼ãƒ‰ã¨åˆ†é›¢
- âœ… **ãƒ–ãƒ©ã‚¦ã‚¶ã«ééœ²å‡º**: HTMLã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã«è¡¨ç¤ºã•ã‚Œãªã„
- âœ… **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå›ºæœ‰**: ä»–ã®GASãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ä¸å¯

#### æ³¨æ„äº‹é …
- âŒ **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…±æœ‰ç¦æ­¢**: GASãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä»–è€…ã¨å…±æœ‰ã—ãªã„
- âš ï¸ **å®šæœŸçš„ãªãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³**: 3-6ãƒ¶æœˆã”ã¨ã«APIã‚­ãƒ¼ã‚’æ›´æ–°
- ğŸ”’ **æ¼æ´©æ™‚ã®å¯¾å¿œ**: å³åº§ã«Threads Developer Consoleã§ç„¡åŠ¹åŒ–

### 3. ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡

#### æ¨å¥¨è¨­å®š
- **å…±æœ‰è¨­å®š**: ã€Œãƒªãƒ³ã‚¯ã‚’çŸ¥ã£ã¦ã„ã‚‹å…¨å“¡ï¼ˆé–²è¦§ã®ã¿ï¼‰ã€ã¾ãŸã¯ã€Œç‰¹å®šã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿ã€
- **ç·¨é›†æ¨©é™**: ã‚¹ã‚¯ãƒªãƒ—ãƒˆæ‰€æœ‰è€…ã®ã¿
- **ç†ç”±**: ãƒ‡ãƒ¼ã‚¿ã®ä¸æ­£æ”¹ã–ã‚“é˜²æ­¢

#### ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‹ã‚‰ã®ã‚¢ã‚¯ã‚»ã‚¹
```typescript
// ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆIDã‚’ä½¿ç”¨ã—ã¦ã‚¢ã‚¯ã‚»ã‚¹
const spreadsheet = SpreadsheetApp.openById(spreadsheetId);

// æ¨©é™ãƒã‚§ãƒƒã‚¯
if (!spreadsheet) {
  throw new Error('ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã›ã‚“');
}
```

### 4. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ãƒ­ã‚°

#### ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ‘ã‚¿ãƒ¼ãƒ³
```typescript
function safeApiCall<T>(fn: () => T, fallback: T): T {
  try {
    return fn();
  } catch (error) {
    console.error('ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:', error);
    logError('APIå‘¼ã³å‡ºã—ã‚¨ãƒ©ãƒ¼', error);
    return fallback;
  }
}
```

#### ãƒ­ã‚°è¨˜éŒ²
```typescript
function logError(message: string, error: any): void {
  const logSheet = SpreadsheetApp.openById(getSpreadsheetId()).getSheetByName('logs');
  logSheet.appendRow([
    new Date(),
    'ERROR',
    message,
    JSON.stringify(error)
  ]);
}
```

---

## ğŸ”„ ãƒãƒƒãƒå‡¦ç†ä»•æ§˜

### ãƒˆãƒªã‚¬ãƒ¼ä¸€è¦§

| ãƒˆãƒªã‚¬ãƒ¼å | å®Ÿè¡Œé »åº¦ | å®Ÿè¡Œæ™‚åˆ» | é–¢æ•°å | ç›®çš„ |
|-----------|---------|---------|--------|------|
| æ™‚ç³»åˆ—ãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›† | 1æ™‚é–“ã”ã¨ | æ¯æ™‚0åˆ† | `fetchMetricsHourly()` | éå»7æ—¥ä»¥å†…ã®å…¨æŠ•ç¨¿ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’åé›† |
| æ—¥æ¬¡åˆ†æ | æ¯æ—¥ | 9:00 | `runDailyAnalysis()` | æ–°è¦æŠ•ç¨¿ã®è¿½åŠ ã€ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æƒ…å ±æ›´æ–° |
| é€±æ¬¡ãƒ¬ãƒãƒ¼ãƒˆ | æ¯é€±æœˆæ›œ | 10:00 | `generateWeeklyReport()` | é€±æ¬¡ã‚µãƒãƒªãƒ¼ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ |
| æœˆæ¬¡ãƒ¬ãƒãƒ¼ãƒˆ | æ¯æœˆ1æ—¥ | 10:00 | `generateMonthlyReport()` | æœˆæ¬¡è©³ç´°ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ |

---

### æ™‚é–“åŒºåˆ†ãƒ™ãƒ¼ã‚¹ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›†ï¼ˆ1æ™‚é–“ã”ã¨ï¼‰

#### `fetchMetricsHourly()`ã®å‡¦ç†ãƒ•ãƒ­ãƒ¼

```
1. Threads APIã‹ã‚‰æŠ•ç¨¿ä¸€è¦§ã‚’å–å¾—
   â””â”€ threadsApi.getThreads(100)

2. å„æŠ•ç¨¿ã‚’é †ã«ç¢ºèª
   â”œâ”€ æŠ•ç¨¿æ—¥æ™‚ã‹ã‚‰çµŒéæ™‚é–“ã‚’è¨ˆç®—
   â””â”€ æ™‚é–“åŒºåˆ†ã‚’æ±ºå®šï¼ˆ0, 1, 12, 24, 72ï¼‰

3. å„æŠ•ç¨¿ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’APIå–å¾—
   â”œâ”€ threadsApi.getThreadInsights(post_id)
   â”œâ”€ ãƒ¬ãƒ¼ãƒˆåˆ¶é™å¯¾ç­–: 18ç§’é–“éš”ï¼ˆ200ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/æ™‚é–“ï¼‰
   â””â”€ ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼æ•°ã‚‚åŒæ™‚ã«å–å¾—

4. postsã‚·ãƒ¼ãƒˆã«ä¿å­˜
   â”œâ”€ é‡è¤‡ãƒã‚§ãƒƒã‚¯ï¼ˆpost_id Ã— time_categoryï¼‰
   â”œâ”€ æ—¢å­˜ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒã‚ã‚Œã°æ›´æ–°
   â””â”€ ãªã‘ã‚Œã°æ–°è¦è¿½åŠ 

5. å¤ã„ãƒ‡ãƒ¼ã‚¿ã®å‰Šé™¤
   â”œâ”€ posted_at < (ç¾åœ¨ - 7æ—¥) ã®ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤
   â””â”€ ãƒ‡ãƒ¼ã‚¿è‚¥å¤§åŒ–é˜²æ­¢

6. ãƒ­ã‚°è¨˜éŒ²
   â””â”€ åé›†ä»¶æ•°ã€ã‚¨ãƒ©ãƒ¼ã‚’logsã‚·ãƒ¼ãƒˆã«è¨˜éŒ²
```

#### ãƒˆãƒªã‚¬ãƒ¼è¨­å®šæ–¹æ³•

```javascript
function setupHourlyTrigger() {
  // æ—¢å­˜ã®ãƒˆãƒªã‚¬ãƒ¼ã‚’å‰Šé™¤
  TriggerManager.deleteTrigger('fetchMetricsHourly');
  
  // 1æ™‚é–“ã”ã¨ã®ãƒˆãƒªã‚¬ãƒ¼ã‚’è¨­å®š
  ScriptApp.newTrigger('fetchMetricsHourly')
    .timeBased()
    .everyHours(1)
    .create();
  
  console.log('æ™‚ç³»åˆ—ãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›†ãƒˆãƒªã‚¬ãƒ¼ã‚’è¨­å®šã—ã¾ã—ãŸ');
}
```

#### å®Ÿè¡Œæ™‚é–“ã®ç›®å®‰

| æŠ•ç¨¿æ•° | APIå‘¼ã³å‡ºã—æ™‚é–“ | ãƒ‡ãƒ¼ã‚¿ä¿å­˜æ™‚é–“ | åˆè¨ˆ |
|-------|----------------|---------------|------|
| 10ä»¶ | ç´„3åˆ† | ç´„10ç§’ | **ç´„3åˆ†10ç§’** |
| 30ä»¶ | ç´„9åˆ† | ç´„30ç§’ | **ç´„9åˆ†30ç§’** |
| 50ä»¶ | ç´„15åˆ† | ç´„50ç§’ | **ç´„15åˆ†50ç§’** |

**æ³¨æ„**: GASã®æœ€å¤§å®Ÿè¡Œæ™‚é–“ã¯6åˆ†ï¼ˆç„¡æ–™ç‰ˆï¼‰ã¾ãŸã¯30åˆ†ï¼ˆWorkspaceï¼‰ã€‚æŠ•ç¨¿æ•°ãŒå¤šã„å ´åˆã¯ãƒãƒƒãƒåˆ†å‰²ã‚’æ¤œè¨ã€‚

---

### æ—¥æ¬¡ãƒãƒƒãƒï¼ˆæ¯æ—¥9:00å®Ÿè¡Œï¼‰

#### `runDailyAnalysis()`ã®å‡¦ç†ãƒ•ãƒ­ãƒ¼

```
1. è¨­å®šãƒã‚§ãƒƒã‚¯
   â”œâ”€ APIã‚­ãƒ¼ã®å­˜åœ¨ç¢ºèª
   â”œâ”€ ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆIDã®å­˜åœ¨ç¢ºèª
   â””â”€ ã‚¨ãƒ©ãƒ¼ã®å ´åˆã¯å‡¦ç†ä¸­æ–­

2. ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æƒ…å ±æ›´æ–°
   â”œâ”€ threadsApi.getUserProfile() å‘¼ã³å‡ºã—
   â”œâ”€ ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼æ•°å–å¾—
   â””â”€ profileã‚·ãƒ¼ãƒˆã«ä¿å­˜

3. æ–°è¦æŠ•ç¨¿ãƒ‡ãƒ¼ã‚¿å–å¾—
   â”œâ”€ threadsApi.getThreads(100) å‘¼ã³å‡ºã—
   â”œâ”€ éå»24æ™‚é–“ã®æŠ•ç¨¿ã‚’å¯¾è±¡
   â””â”€ postsã‚·ãƒ¼ãƒˆã«è¿½åŠ 

4. æ—¢å­˜æŠ•ç¨¿ã®ã‚¤ãƒ³ã‚µã‚¤ãƒˆæ›´æ–°
   â”œâ”€ 12æ™‚é–“å‰ã€24æ™‚é–“å‰ã€72æ™‚é–“å‰ã€7æ—¥å‰ã®æŠ•ç¨¿ã‚’æŠ½å‡º
   â”œâ”€ threadsApi.getThreadInsights(threadId) å‘¼ã³å‡ºã—
   â””â”€ postsã‚·ãƒ¼ãƒˆã‚’æ›´æ–°

5. å¹³å‡å€¤è¨ˆç®—
   â”œâ”€ dataProcessor.calculateAverages() å‘¼ã³å‡ºã—
   â”œâ”€ éå»30æ—¥åˆ†ã®å¹³å‡ã‚’è¨ˆç®—
   â””â”€ configã‚·ãƒ¼ãƒˆã«ä¿å­˜

6. ãƒ­ã‚°è¨˜éŒ²
   â”œâ”€ å‡¦ç†æ™‚é–“ã€å–å¾—ä»¶æ•°ã‚’è¨˜éŒ²
   â””â”€ logsã‚·ãƒ¼ãƒˆã«ä¿å­˜
```

#### å®Ÿè£…ä¾‹
```typescript
function runDailyAnalysis(): { success: boolean; message: string } {
  try {
    // 1. è¨­å®šãƒã‚§ãƒƒã‚¯
    const apiKey = getApiKey();
    const userId = getUserId();
    const spreadsheetId = getSpreadsheetId();
    
    if (!apiKey || !userId || !spreadsheetId) {
      throw new Error('è¨­å®šãŒä¸å®Œå…¨ã§ã™');
    }
    
    // 2. åˆæœŸåŒ–
    const api = new ThreadsApi(apiKey, userId);
    const manager = new SpreadsheetManager(spreadsheetId);
    const processor = new DataProcessor();
    
    // 3. ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æ›´æ–°
    const profile = api.getUserProfile();
    manager.initializeSheet('profile');
    manager.appendRow([
      new Date(),
      profile.followers_count,
      profile.username,
      `https://threads.net/@${profile.username}`
    ]);
    
    // 4. æ–°è¦æŠ•ç¨¿å–å¾—
    const threads = api.getThreads(100);
    for (const thread of threads.data) {
      const existingRow = manager.findRowByThreadId(thread.id);
      if (existingRow === null) {
        manager.appendRow([
          thread.id,
          thread.timestamp,
          thread.text,
          processor.countCharacters(thread.text),
          thread.media_type,
          0, 0, 0, 0, 0, // åˆæœŸå€¤
          new Date(),
          new Date()
        ]);
      }
    }
    
    // 5. ã‚¤ãƒ³ã‚µã‚¤ãƒˆæ›´æ–°
    const now = new Date();
    const allData = manager.getAllData();
    
    for (let i = 1; i < allData.length; i++) {
      const postDate = new Date(allData[i][1]);
      const hoursSincePost = (now.getTime() - postDate.getTime()) / (1000 * 60 * 60);
      
      if (hoursSincePost >= 12 && hoursSincePost < 13) {
        const insights = api.getThreadInsights(allData[i][0]);
        manager.updateRow(i + 1, [
          allData[i][0],
          allData[i][1],
          allData[i][2],
          allData[i][3],
          allData[i][4],
          insights.likes_count,
          insights.replies_count,
          insights.reposts_count,
          insights.impressions,
          processor.calculateEngagementRate(
            insights.likes_count,
            insights.replies_count,
            insights.reposts_count,
            insights.impressions
          ),
          allData[i][10],
          new Date()
        ]);
      }
    }
    
    // 6. å¹³å‡å€¤è¨ˆç®—
    const averages = processor.calculateAverages(allData);
    setPropertySafely('avg_likes', averages.avgLikes.toString());
    setPropertySafely('avg_engagement_rate', averages.avgEngagementRate.toString());
    
    // 7. ãƒ­ã‚°è¨˜éŒ²
    logInfo('æ—¥æ¬¡åˆ†æãŒå®Œäº†ã—ã¾ã—ãŸ');
    
    return { success: true, message: 'åˆ†æãŒå®Œäº†ã—ã¾ã—ãŸ' };
    
  } catch (error) {
    logError('æ—¥æ¬¡åˆ†æã‚¨ãƒ©ãƒ¼', error);
    return { success: false, message: `ã‚¨ãƒ©ãƒ¼: ${error.message}` };
  }
}
```

### é€±æ¬¡ãƒãƒƒãƒï¼ˆæœˆæ›œ10:00å®Ÿè¡Œï¼‰

#### `generateWeeklyReport()`ã®å‡¦ç†ãƒ•ãƒ­ãƒ¼

```
1. æœŸé–“è¨­å®š
   â””â”€ å‰é€±ã®æœˆæ›œã€œæ—¥æ›œ

2. ãƒ‡ãƒ¼ã‚¿å–å¾—
   â””â”€ spreadsheetManager.getDataByDate() ã§1é€±é–“åˆ†å–å¾—

3. ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
   â”œâ”€ ç·æŠ•ç¨¿æ•°
   â”œâ”€ å¹³å‡ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆç‡
   â”œâ”€ æœ€ã‚‚åå¿œãŒè‰¯ã‹ã£ãŸæŠ•ç¨¿
   â””â”€ ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼å¢—åŠ æ•°

4. ãƒ¡ãƒ¼ãƒ«é€ä¿¡ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
   â””â”€ reportGenerator.sendReportEmail()
```

### æœˆæ¬¡ãƒãƒƒãƒï¼ˆæ¯æœˆ1æ—¥10:00å®Ÿè¡Œï¼‰

#### `generateMonthlyReport()`ã®å‡¦ç†ãƒ•ãƒ­ãƒ¼

```
1. æœŸé–“è¨­å®š
   â””â”€ å‰æœˆ1æ—¥ã€œæœ«æ—¥

2. ãƒ‡ãƒ¼ã‚¿å–å¾—
   â””â”€ spreadsheetManager.getDataByDate() ã§1ãƒ¶æœˆåˆ†å–å¾—

3. è©³ç´°åˆ†æ
   â”œâ”€ æœˆé–“ã‚µãƒãƒªãƒ¼
   â”œâ”€ äººæ°—æŠ•ç¨¿Top10
   â”œâ”€ æŠ•ç¨¿æ™‚é–“å¸¯åˆ†æ
   â””â”€ ãƒˆãƒ¬ãƒ³ãƒ‰æ¨ç§»

4. ãƒ¬ãƒãƒ¼ãƒˆä¿å­˜
   â””â”€ HTMLãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦å‡ºåŠ›
```

---

## ğŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †

### 1. é–‹ç™ºç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
# ãƒªãƒã‚¸ãƒˆãƒªã‚¯ãƒ­ãƒ¼ãƒ³
git clone <repository-url>
cd threads_post_analysis

# Node.jsä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install

# claspã§Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«ãƒ­ã‚°ã‚¤ãƒ³
clasp login

# Google Apps Script APIã‚’æœ‰åŠ¹åŒ–
# https://script.google.com/home/usersettings
```

### 2. GASãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ

```bash
# æ–°ã—ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ
clasp create --title "ThreadsæŠ•ç¨¿åˆ†æãƒ„ãƒ¼ãƒ«" --type standalone

# .clasp.jsonãŒè‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹
```

### 3. TypeScriptãƒ“ãƒ«ãƒ‰ï¼†ãƒ‡ãƒ—ãƒ­ã‚¤

```bash
# TypeScriptã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«
npm run build

# GASã«ãƒ—ãƒƒã‚·ãƒ¥
clasp push

# ã¾ãŸã¯ä¸€æ‹¬å®Ÿè¡Œ
npm run push
```

### 4. Webã‚¢ãƒ—ãƒªãƒ‡ãƒ—ãƒ­ã‚¤

1. GASã‚¨ãƒ‡ã‚£ã‚¿ã‚’é–‹ã: `clasp open`
2. ã€Œãƒ‡ãƒ—ãƒ­ã‚¤ã€â†’ã€Œæ–°ã—ã„ãƒ‡ãƒ—ãƒ­ã‚¤ã€ã‚’ã‚¯ãƒªãƒƒã‚¯
3. ã€Œç¨®é¡ã‚’é¸æŠã€â†’ã€Œã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã€ã‚’é¸æŠ
4. è¨­å®š:
   - **èª¬æ˜**: `åˆå›ãƒ‡ãƒ—ãƒ­ã‚¤`
   - **æ¬¡ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã—ã¦å®Ÿè¡Œ**: `è‡ªåˆ†`
   - **ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼**: `å…¨å“¡`ï¼ˆã¾ãŸã¯ `è‡ªåˆ†ã®ã¿`ï¼‰
5. ã€Œãƒ‡ãƒ—ãƒ­ã‚¤ã€ã‚’ã‚¯ãƒªãƒƒã‚¯
6. **ãƒ‡ãƒ—ãƒ­ã‚¤ID**ã¨**Webã‚¢ãƒ—ãƒªã®URL**ã‚’ã‚³ãƒ”ãƒ¼

### 5. ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆä½œæˆ

1. Google Sheetsã§æ–°ã—ã„ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’ä½œæˆ
2. ã‚·ãƒ¼ãƒˆåã‚’ä»¥ä¸‹ã«å¤‰æ›´:
   - `posts`
   - `profile`
   - `config`
   - `logs`
3. ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®URLã‹ã‚‰IDã‚’ã‚³ãƒ”ãƒ¼:
   ```
   https://docs.google.com/spreadsheets/d/{ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆID}/edit
   ```

### 6. Webã‚¢ãƒ—ãƒªã§åˆæœŸè¨­å®š

1. Webã‚¢ãƒ—ãƒªã®URLã«ã‚¢ã‚¯ã‚»ã‚¹
2. ã€Œè¨­å®šã€ã‚¿ãƒ–ã‚’é–‹ã
3. ä»¥ä¸‹ã‚’å…¥åŠ›:
   - **Threads API Key**: Threads Developer Consoleã§å–å¾—
   - **Threads User ID**: è‡ªåˆ†ã®Threadsãƒ¦ãƒ¼ã‚¶ãƒ¼ID
   - **Spreadsheet ID**: æ‰‹é †5ã§ã‚³ãƒ”ãƒ¼ã—ãŸID
4. å„ã€Œä¿å­˜ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯

### 7. ãƒˆãƒªã‚¬ãƒ¼è¨­å®š

GASã‚¨ãƒ‡ã‚£ã‚¿ã§ä»¥ä¸‹ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œ:

```javascript
function setupAllTriggers() {
  // æ—¥æ¬¡ãƒãƒƒãƒï¼ˆæ¯æ—¥9:00ï¼‰
  TriggerManager.setupDailyTrigger('runDailyAnalysis', 9);
  
  // é€±æ¬¡ãƒ¬ãƒãƒ¼ãƒˆï¼ˆæœˆæ›œ10:00ï¼‰
  TriggerManager.setupWeeklyTrigger('generateWeeklyReport', ScriptApp.WeekDay.MONDAY, 10);
  
  // æœˆæ¬¡ãƒ¬ãƒãƒ¼ãƒˆï¼ˆæ¯æœˆ1æ—¥10:00ï¼‰
  TriggerManager.setupMonthlyTrigger('generateMonthlyReport', 1, 10);
  
  console.log('å…¨ã¦ã®ãƒˆãƒªã‚¬ãƒ¼ã‚’è¨­å®šã—ã¾ã—ãŸ');
}
```

### 8. å‹•ä½œç¢ºèª

1. ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚¿ãƒ–ã§ã€Œåˆ†æã‚’å®Ÿè¡Œã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
2. æ•°ç§’å¾Œã€ã€Œãƒ‡ãƒ¼ã‚¿ã€ã‚¿ãƒ–ã«æŠ•ç¨¿ãƒ‡ãƒ¼ã‚¿ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
3. ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«ãƒ‡ãƒ¼ã‚¿ãŒä¿å­˜ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª

---

## ğŸ§ª ãƒ†ã‚¹ãƒˆ

### æ‰‹å‹•ãƒ†ã‚¹ãƒˆé …ç›®

#### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
- [ ] ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚¿ãƒ–ãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] ãƒ‡ãƒ¼ã‚¿ã‚¿ãƒ–ã§ãƒ†ãƒ¼ãƒ–ãƒ«ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] è¨­å®šã‚¿ãƒ–ã§APIã‚­ãƒ¼ã‚’ä¿å­˜ã§ãã‚‹
- [ ] åˆ†æå®Ÿè¡Œãƒœã‚¿ãƒ³ãŒå‹•ä½œã™ã‚‹
- [ ] ã‚½ãƒ¼ãƒˆæ©Ÿèƒ½ãŒå‹•ä½œã™ã‚‹
- [ ] ãƒã‚¤ãƒ©ã‚¤ãƒˆæ©Ÿèƒ½ãŒå‹•ä½œã™ã‚‹

#### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
- [ ] `runAnalysis()` ãŒæ­£å¸¸ã«å®Ÿè¡Œã•ã‚Œã‚‹
- [ ] Threads APIã‹ã‚‰æŠ•ç¨¿ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã§ãã‚‹
- [ ] ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«ãƒ‡ãƒ¼ã‚¿ãŒä¿å­˜ã•ã‚Œã‚‹
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒå‹•ä½œã™ã‚‹
- [ ] ãƒˆãƒªã‚¬ãƒ¼ãŒæ­£ã—ãè¨­å®šã•ã‚Œã‚‹

### GASã‚¨ãƒ‡ã‚£ã‚¿ã§ã®ãƒ†ã‚¹ãƒˆ

```javascript
// APIã‚­ãƒ¼ä¿å­˜ãƒ†ã‚¹ãƒˆ
function testSaveApiKey() {
  const result = saveApiKey('test_api_key_12345');
  console.log(result);
}

// ãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ†ã‚¹ãƒˆ
function testGetThreads() {
  const api = new ThreadsApi(getApiKey(), getUserId());
  const threads = api.getThreads(10);
  console.log(threads);
}

// ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆæ›¸ãè¾¼ã¿ãƒ†ã‚¹ãƒˆ
function testSpreadsheetWrite() {
  const manager = new SpreadsheetManager(getSpreadsheetId());
  manager.initializeSheet('posts');
  manager.appendRow(['test_id', new Date(), 'ãƒ†ã‚¹ãƒˆæŠ•ç¨¿', 5, 'TEXT', 0, 0, 0, 0, 0, new Date(), new Date()]);
}
```

---

## ğŸ“Š ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ä»•æ§˜

### å‡¦ç†æ™‚é–“ã®ç›®æ¨™

| å‡¦ç† | ç›®æ¨™æ™‚é–“ | å‚™è€ƒ |
|-----|---------|------|
| Webã‚¢ãƒ—ãƒªåˆå›è¡¨ç¤º | < 3ç§’ | HTMLãƒ­ãƒ¼ãƒ‰ï¼‹åˆæœŸãƒ‡ãƒ¼ã‚¿å–å¾— |
| ãƒ‡ãƒ¼ã‚¿ã‚¿ãƒ–è¡¨ç¤º | < 2ç§’ | 100ä»¶ã®ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º |
| åˆ†æå®Ÿè¡Œï¼ˆ100ä»¶ï¼‰ | < 30ç§’ | APIå‘¼ã³å‡ºã—ï¼‹ãƒ‡ãƒ¼ã‚¿ä¿å­˜ |
| æœˆæ¬¡ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ | < 60ç§’ | 1ãƒ¶æœˆåˆ†ï¼ˆæœ€å¤§3000ä»¶ï¼‰ã®åˆ†æ |

### æœ€é©åŒ–æ‰‹æ³•

#### 1. ãƒãƒƒãƒæ›¸ãè¾¼ã¿
```typescript
// æ‚ªã„ä¾‹ï¼ˆ1è¡Œãšã¤æ›¸ãè¾¼ã¿ï¼‰
for (const data of dataArray) {
  sheet.appendRow(data); // æ¯å›APIå‘¼ã³å‡ºã—
}

// è‰¯ã„ä¾‹ï¼ˆä¸€æ‹¬æ›¸ãè¾¼ã¿ï¼‰
const batchData = dataArray.map(d => [d.id, d.name, d.value]);
sheet.getRange(2, 1, batchData.length, batchData[0].length).setValues(batchData);
```

#### 2. ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®æ´»ç”¨
```typescript
const cache = CacheService.getScriptCache();

// ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‹ã‚‰å–å¾—
let data = cache.get('follower_count');
if (!data) {
  // APIã‹ã‚‰å–å¾—
  data = api.getUserProfile().followers_count;
  // 1æ™‚é–“ã‚­ãƒ£ãƒƒã‚·ãƒ¥
  cache.put('follower_count', data, 3600);
}
```

#### 3. ãƒ¬ãƒ¼ãƒˆåˆ¶é™å¯¾å¿œ
```typescript
private waitForRateLimit(): void {
  const lastCallTime = parseInt(CacheService.getScriptCache().get('last_api_call') || '0');
  const now = Date.now();
  const minInterval = 18000; // 18ç§’ï¼ˆ200ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/æ™‚é–“ï¼‰
  
  if (now - lastCallTime < minInterval) {
    Utilities.sleep(minInterval - (now - lastCallTime));
  }
  
  CacheService.getScriptCache().put('last_api_call', now.toString(), 3600);
}
```

---

## âš ï¸ é‹ç”¨æ³¨æ„ç‚¹ & æ‹¡å¼µæ¡ˆ

### é‹ç”¨ä¸Šã®æ³¨æ„ç‚¹

#### 1. APIåˆ¶é™ã¨ãƒ¬ãƒ¼ãƒˆå¯¾ç­–

| é …ç›® | åˆ¶é™ | å¯¾ç­– |
|------|------|------|
| Threads API | 200ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/æ™‚é–“ | 18ç§’é–“éš”ã§å‘¼ã³å‡ºã— |
| GASå®Ÿè¡Œæ™‚é–“ | 6åˆ†ï¼ˆç„¡æ–™ï¼‰/ 30åˆ†ï¼ˆWorkspaceï¼‰ | æŠ•ç¨¿æ•°ãŒå¤šã„å ´åˆã¯ãƒãƒƒãƒåˆ†å‰² |
| ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆæ›¸ãè¾¼ã¿ | åˆ¶é™ãªã— | ãƒãƒƒãƒæ›¸ãè¾¼ã¿ã§é«˜é€ŸåŒ– |

**æŠ•ç¨¿æ•°ãŒå¤šã„å ´åˆã®å¯¾ç­–**:
```javascript
function fetchMetricsHourlyBatch() {
  const posts = getRecentPosts(7);
  const batchSize = 15; // 1å›ã®ãƒãƒƒãƒã§15ä»¶ã¾ã§ï¼ˆç´„4.5åˆ†ï¼‰
  
  const batches = [];
  for (let i = 0; i < posts.length; i += batchSize) {
    batches.push(posts.slice(i, i + batchSize));
  }
  
  // æœ€åˆã®ãƒãƒƒãƒã®ã¿å®Ÿè¡Œï¼ˆæ¬¡å›ã®ãƒˆãƒªã‚¬ãƒ¼ã§ç¶šãã‚’å®Ÿè¡Œï¼‰
  const batchIndex = parseInt(PropertiesService.getScriptProperties().getProperty('batch_index') || '0');
  
  if (batchIndex < batches.length) {
    fetchMetricsBatch(batches[batchIndex]);
    PropertiesService.getScriptProperties().setProperty('batch_index', (batchIndex + 1).toString());
  } else {
    // å…¨ãƒãƒƒãƒå®Œäº†
    PropertiesService.getScriptProperties().setProperty('batch_index', '0');
  }
}
```

#### 2. ãƒ‡ãƒ¼ã‚¿è‚¥å¤§åŒ–å¯¾ç­–

**å•é¡Œ**: `post_metrics_hourly`ã‚·ãƒ¼ãƒˆãŒè‚¥å¤§åŒ–ã™ã‚‹

**å¯¾ç­–**:
- âœ… **7æ—¥ä»¥ä¸Šã®ãƒ‡ãƒ¼ã‚¿ã¯è‡ªå‹•å‰Šé™¤**: `deleteOldMetrics()`ã§å®Ÿè£…æ¸ˆã¿
- âœ… **æœˆæ¬¡ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—**: æœˆåˆã«åˆ¥ã‚·ãƒ¼ãƒˆï¼ˆ`archive_YYYYMM`ï¼‰ã«ã‚³ãƒ”ãƒ¼
- âœ… **BigQueryã¸ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ**: é•·æœŸä¿å­˜ãŒå¿…è¦ãªå ´åˆã¯BigQueryã¸ç§»è¡Œ

```javascript
function archiveMonthlyData() {
  const sheet = SpreadsheetApp.getActive().getSheetByName('post_metrics_hourly');
  const lastMonth = new Date();
  lastMonth.setMonth(lastMonth.getMonth() - 1);
  
  const archiveSheetName = `archive_${lastMonth.getFullYear()}${String(lastMonth.getMonth() + 1).padStart(2, '0')}`;
  const archiveSheet = SpreadsheetApp.getActive().insertSheet(archiveSheetName);
  
  // ãƒ‡ãƒ¼ã‚¿ã‚’ã‚³ãƒ”ãƒ¼
  const values = sheet.getDataRange().getValues();
  const archiveData = values.filter((row, index) => {
    if (index === 0) return true; // ãƒ˜ãƒƒãƒ€ãƒ¼
    const capturedAt = new Date(row[1]);
    return capturedAt.getMonth() === lastMonth.getMonth();
  });
  
  archiveSheet.getRange(1, 1, archiveData.length, archiveData[0].length).setValues(archiveData);
}
```

#### 3. ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³çµ±ä¸€

**é‡è¦**: ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã¨GASã®ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã‚’ **JSTï¼ˆAsia/Tokyoï¼‰** ã«çµ±ä¸€

**è¨­å®šæ–¹æ³•**:
1. **appsscript.json**:
```json
{
  "timeZone": "Asia/Tokyo"
}
```

2. **ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³**:
   - ãƒ•ã‚¡ã‚¤ãƒ« â†’ è¨­å®š â†’ ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ â†’ `(GMT+09:00) æ±äº¬`

#### 4. ã‚¨ãƒ©ãƒ¼é€šçŸ¥

**æ¨å¥¨**: ãƒãƒƒãƒå‡¦ç†ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆã€ãƒ¡ãƒ¼ãƒ«é€šçŸ¥ã‚’é€ä¿¡

```javascript
function sendErrorNotification(error: any, functionName: string): void {
  const recipient = Session.getActiveUser().getEmail();
  const subject = `ã€ã‚¨ãƒ©ãƒ¼ã€‘Threadsåˆ†æãƒ„ãƒ¼ãƒ« - ${functionName}`;
  const body = `
ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚

é–¢æ•°å: ${functionName}
æ™‚åˆ»: ${new Date().toLocaleString('ja-JP')}
ã‚¨ãƒ©ãƒ¼: ${error.message}
ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹: ${error.stack}

ãƒ­ã‚°ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚
  `;
  
  MailApp.sendEmail(recipient, subject, body);
}
```

---

### å°†æ¥ã®æ‹¡å¼µæ¡ˆ

#### 1. BigQueryé€£æº

**ç›®çš„**: é•·æœŸãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜ã¨é«˜é€Ÿåˆ†æ

**å®Ÿè£…æ–¹é‡**:
- GASã‹ã‚‰å®šæœŸçš„ã«BigQueryã«ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
- Looker Studioã§ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰Plaã‚’ä½œæˆ

```javascript
function exportToBigQuery() {
  const projectId = 'your-project-id';
  const datasetId = 'threads_analysis';
  const tableId = 'post_metrics_hourly';
  
  const sheet = SpreadsheetApp.getActive().getSheetByName('post_metrics_hourly');
  const values = sheet.getDataRange().getValues();
  
  // BigQuery APIã§æŒ¿å…¥ï¼ˆçœç•¥ï¼‰
}
```

#### 2. Firestoreé€£æº

**ç›®çš„**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ€§ã®å‘ä¸Š

**å®Ÿè£…æ–¹é‡**:
- GASã‹ã‚‰Firestoreã«ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜
- Webã‚¢ãƒ—ãƒªã§ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°

#### 3. ãƒãƒ«ãƒã‚¢ã‚«ã‚¦ãƒ³ãƒˆå¯¾å¿œ

**ç›®çš„**: è¤‡æ•°ã®Threadsã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä¸€å…ƒç®¡ç†

**å®Ÿè£…æ–¹é‡**:
- `accounts`ã‚·ãƒ¼ãƒˆã‚’è¿½åŠ 
- UIã§ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåˆ‡ã‚Šæ›¿ãˆæ©Ÿèƒ½ã‚’å®Ÿè£…

#### 4. ç«¶åˆåˆ†ææ©Ÿèƒ½

**ç›®çš„**: ç«¶åˆã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚‚åé›†ãƒ»æ¯”è¼ƒ

**å®Ÿè£…æ–¹é‡**:
- Threads APIã§ä»–ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®å…¬é–‹ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
- æ¯”è¼ƒã‚°ãƒ©ãƒ•ã‚’è¡¨ç¤º

#### 5. AIåˆ†ææ©Ÿèƒ½

**ç›®çš„**: æŠ•ç¨¿å†…å®¹ã¨ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆã®ç›¸é–¢åˆ†æ

**å®Ÿè£…æ–¹é‡**:
- Gemini APIã§æŠ•ç¨¿æ–‡ã‚’ãƒˆãƒ”ãƒƒã‚¯åˆ†é¡
- ãƒˆãƒ”ãƒƒã‚¯ã”ã¨ã®ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆç‡ã‚’åˆ†æ
- ãŠã™ã™ã‚ã®æŠ•ç¨¿æ™‚é–“ãƒ»å†…å®¹ã‚’ææ¡ˆ

---

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [ ] ãƒãƒƒãƒæ›¸ãè¾¼ã¿ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹
- [ ] ä¸è¦ãªAPIå‘¼ã³å‡ºã—ã‚’å‰Šæ¸›ã—ã¦ã„ã‚‹
- [ ] CacheServiceã‚’æ´»ç”¨ã—ã¦ã„ã‚‹
- [ ] ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã«å¯¾å¿œã—ã¦ã„ã‚‹
- [ ] å¤ã„ãƒ‡ãƒ¼ã‚¿ã‚’å®šæœŸçš„ã«å‰Šé™¤ã—ã¦ã„ã‚‹
- [ ] ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®ç¯„å›²ã‚’é©åˆ‡ã«æŒ‡å®šã—ã¦ã„ã‚‹ï¼ˆ`getDataRange()`ã®ä¹±ç”¨ã‚’é¿ã‘ã‚‹ï¼‰

---

## ğŸ“ é–‹ç™ºã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

### ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„

#### å‘½åè¦å‰‡
- **é–¢æ•°å**: ã‚­ãƒ£ãƒ¡ãƒ«ã‚±ãƒ¼ã‚¹ï¼ˆ`getUserProfile`, `calculateEngagementRate`ï¼‰
- **ã‚¯ãƒ©ã‚¹å**: ãƒ‘ã‚¹ã‚«ãƒ«ã‚±ãƒ¼ã‚¹ï¼ˆ`ThreadsApi`, `SpreadsheetManager`ï¼‰
- **å®šæ•°**: ã‚¢ãƒƒãƒ‘ãƒ¼ã‚¹ãƒãƒ¼ã‚¯ã‚±ãƒ¼ã‚¹ï¼ˆ`API_BASE_URL`, `MAX_RETRIES`ï¼‰
- **ãƒ•ã‚¡ã‚¤ãƒ«å**: ã‚­ãƒ£ãƒ¡ãƒ«ã‚±ãƒ¼ã‚¹ï¼ˆ`threadsApi.ts`, `dataProcessor.ts`ï¼‰

#### ã‚³ãƒ¡ãƒ³ãƒˆ
- æ—¥æœ¬èªã§è¨˜è¿°
- é–¢æ•°ã®ä¸Šã«èª¬æ˜ã‚³ãƒ¡ãƒ³ãƒˆã‚’å¿…ãšè¨˜è¿°
- è¤‡é›‘ãªãƒ­ã‚¸ãƒƒã‚¯ã«ã¯è¡Œå†…ã‚³ãƒ¡ãƒ³ãƒˆã‚’è¿½åŠ 

```typescript
/**
 * ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆç‡ã‚’è¨ˆç®—ã™ã‚‹
 * @param likes ã„ã„ã­æ•°
 * @param replies ãƒªãƒ—ãƒ©ã‚¤æ•°
 * @param shares ã‚·ã‚§ã‚¢æ•°
 * @param impressions ã‚¤ãƒ³ãƒ—ãƒ¬ãƒƒã‚·ãƒ§ãƒ³æ•°
 * @returns ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆç‡ï¼ˆ%ï¼‰
 */
function calculateEngagementRate(
  likes: number,
  replies: number,
  shares: number,
  impressions: number
): number {
  if (impressions === 0) return 0;
  
  // ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆ = (ã„ã„ã­ + ãƒªãƒ—ãƒ©ã‚¤ + ã‚·ã‚§ã‚¢) / ã‚¤ãƒ³ãƒ—ãƒ¬ãƒƒã‚·ãƒ§ãƒ³ Ã— 100
  const totalEngagement = likes + replies + shares;
  return (totalEngagement / impressions) * 100;
}
```

#### ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- å¿…ãš `try-catch` ãƒ–ãƒ­ãƒƒã‚¯ã‚’ä½¿ç”¨
- ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ã«
- ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã¯è©³ç´°ã«è¨˜éŒ²

```typescript
function safeOperation(): { success: boolean; message: string; data?: any } {
  try {
    // å‡¦ç†
    const result = performOperation();
    return { success: true, message: 'æˆåŠŸã—ã¾ã—ãŸ', data: result };
  } catch (error) {
    console.error('æ“ä½œã‚¨ãƒ©ãƒ¼:', error);
    logError('safeOperation', error);
    return { success: false, message: 'ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ' };
  }
}
```

### Gité‹ç”¨

#### ãƒ–ãƒ©ãƒ³ãƒæˆ¦ç•¥
- `main`: æœ¬ç•ªç”¨ï¼ˆãƒ‡ãƒ—ãƒ­ã‚¤å¯èƒ½ãªçŠ¶æ…‹ï¼‰
- `develop`: é–‹ç™ºç”¨ï¼ˆæ¬¡ã®ãƒªãƒªãƒ¼ã‚¹æº–å‚™ï¼‰
- `feature/*`: æ©Ÿèƒ½è¿½åŠ ç”¨
- `fix/*`: ãƒã‚°ä¿®æ­£ç”¨

#### ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
```
[ç¨®é¡] ç°¡æ½”ãªèª¬æ˜

è©³ç´°ãªèª¬æ˜ï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰
```

**ç¨®é¡**:
- `feat`: æ–°æ©Ÿèƒ½
- `fix`: ãƒã‚°ä¿®æ­£
- `docs`: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- `style`: ã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
- `refactor`: ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°
- `test`: ãƒ†ã‚¹ãƒˆè¿½åŠ 
- `chore`: ãã®ä»–ï¼ˆãƒ“ãƒ«ãƒ‰è¨­å®šãªã©ï¼‰

**ä¾‹**:
```
feat: é€±æ¬¡ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆæ©Ÿèƒ½ã‚’è¿½åŠ 

- ReportGeneratorã‚¯ãƒ©ã‚¹ã«generateWeeklyReport()ã‚’å®Ÿè£…
- é€±æ¬¡ãƒˆãƒªã‚¬ãƒ¼ã‚’è¿½åŠ 
- ãƒ¬ãƒãƒ¼ãƒˆHTMLãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½œæˆ
```

---

## ğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ–¹æ³•

#### 1. ã€Œã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã›ã‚“ã€

**åŸå› **: ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆIDãŒé–“é•ã£ã¦ã„ã‚‹ã€ã¾ãŸã¯æ¨©é™ãŒãªã„

**è§£æ±ºæ–¹æ³•**:
1. ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®URLã‹ã‚‰IDã‚’å†ç¢ºèª
2. ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®å…±æœ‰è¨­å®šã§è‡ªåˆ†ãŒç·¨é›†æ¨©é™ã‚’æŒã£ã¦ã„ã‚‹ã‹ç¢ºèª
3. GASãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¨ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆãŒåŒã˜Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‹ç¢ºèª

#### 2. ã€ŒAPIå‘¼ã³å‡ºã—ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€

**åŸå› **: APIã‚­ãƒ¼ãŒç„¡åŠ¹ã€ã¾ãŸã¯ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã«é”ã—ãŸ

**è§£æ±ºæ–¹æ³•**:
1. Threads Developer Consoleã§APIã‚­ãƒ¼ã®æœ‰åŠ¹æ€§ã‚’ç¢ºèª
2. APIã‚­ãƒ¼ã‚’å†ç”Ÿæˆã—ã¦è¨­å®šã—ç›´ã™
3. ãƒ¬ãƒ¼ãƒˆåˆ¶é™ï¼ˆ200ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/æ™‚é–“ï¼‰ã‚’è¶…ãˆã¦ã„ãªã„ã‹ç¢ºèª
4. 1æ™‚é–“å¾…ã£ã¦ã‹ã‚‰å†å®Ÿè¡Œ

#### 3. ã€Œãƒˆãƒªã‚¬ãƒ¼ãŒå®Ÿè¡Œã•ã‚Œãªã„ã€

**åŸå› **: ãƒˆãƒªã‚¬ãƒ¼ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ãªã„

**è§£æ±ºæ–¹æ³•**:
1. GASã‚¨ãƒ‡ã‚£ã‚¿ã§ã€Œãƒˆãƒªã‚¬ãƒ¼ã€ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é–‹ã
2. è¨­å®šã•ã‚Œã¦ã„ã‚‹ãƒˆãƒªã‚¬ãƒ¼ã‚’ç¢ºèª
3. å¿…è¦ã«å¿œã˜ã¦å‰Šé™¤ã—ã¦å†è¨­å®š
4. å®Ÿè¡Œãƒ­ã‚°ã§ã‚¨ãƒ©ãƒ¼ã‚’ç¢ºèª

#### 4. ã€Œãƒ‡ãƒ¼ã‚¿ãŒè¡¨ç¤ºã•ã‚Œãªã„ã€

**åŸå› **: ãƒ‡ãƒ¼ã‚¿å–å¾—ã«å¤±æ•—ã—ã¦ã„ã‚‹ã€ã¾ãŸã¯ã‚·ãƒ¼ãƒˆæ§‹é€ ãŒé–“é•ã£ã¦ã„ã‚‹

**è§£æ±ºæ–¹æ³•**:
1. GASã‚¨ãƒ‡ã‚£ã‚¿ã§ `runAnalysis()` ã‚’æ‰‹å‹•å®Ÿè¡Œã—ã¦ãƒ­ã‚°ã‚’ç¢ºèª
2. ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®ã‚·ãƒ¼ãƒˆåãŒ `posts`, `profile`, `config`, `logs` ã«ãªã£ã¦ã„ã‚‹ã‹ç¢ºèª
3. ãƒ‡ãƒ¼ã‚¿ã‚¿ãƒ–ã®JavaScriptã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ã‚¨ãƒ©ãƒ¼ã‚’ç¢ºèª

---

## ğŸ“š å‚è€ƒãƒªãƒ³ã‚¯

### å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- [Google Apps Scriptå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://developers.google.com/apps-script)
- [Threads APIå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://developers.facebook.com/docs/threads)
- [Google Sheets API](https://developers.google.com/sheets/api)

### ãƒ„ãƒ¼ãƒ«
- [claspï¼ˆGoogleå…¬å¼CLIï¼‰](https://github.com/google/clasp)
- [Apps Script Dashboard](https://script.google.com/home)
- [Threads Developer Console](https://developers.facebook.com/)

### ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- [è¨­å®šæƒ…å ±ã®ä¿æŒæ–¹æ³•](./CONFIGURATION.md)
- [ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä»•æ§˜](./security.md)
- [æ‰‹å‹•å®Ÿè¡Œã‚¬ã‚¤ãƒ‰](./MANUAL_EXECUTION.md)
- [å‹•çš„ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿](./DYNAMIC_DATA_LOADING.md)

---

## ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

MIT License

---

## ğŸ“ ã‚µãƒãƒ¼ãƒˆ

å•é¡Œã‚„è³ªå•ãŒã‚ã‚‹å ´åˆã¯ã€GitHubã®Issueã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

---

**æœ€çµ‚æ›´æ–°**: 2024å¹´11æœˆ27æ—¥
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0.0
**ä½œæˆè€…**: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒãƒ¼ãƒ 
