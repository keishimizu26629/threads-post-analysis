<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ã‚¹ãƒ¬ãƒƒã‚ºåˆ†æãƒ„ãƒ¼ãƒ« UIã‚¤ãƒ¡ãƒ¼ã‚¸ï¼ˆæœ€çµ‚ç‰ˆãƒ»æ”¹ï¼‰</title>
    <style>
      body {
        font-family:
          -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        background-color: #f0f2f5;
        color: #333;
        margin: 0;
        padding: 20px;
      }
      .container {
        max-width: 1400px;
        margin: 0 auto;
        background-color: #fff;
        border: 1px solid #ccc;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        border-radius: 8px;
        overflow: hidden;
      }

      /* ã‚·ãƒ¼ãƒˆã®ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ */
      .sheet-tabs {
        display: flex;
        background-color: #f9f9f9;
        border-bottom: 2px solid #1a73e8;
        padding-left: 15px;
      }
      .tab {
        padding: 10px 18px;
        cursor: pointer;
        border: 1px solid transparent;
        border-bottom: none;
        user-select: none;
        color: #5f6368;
        font-weight: 500;
      }
      .tab.active {
        background-color: #fff;
        color: #1a73e8;
        border-top: 2px solid #1a73e8;
        border-left: 1px solid #ccc;
        border-right: 1px solid #ccc;
        border-radius: 6px 6px 0 0;
        position: relative;
        bottom: -2px;
        z-index: 2;
      }
      .tab:not(.active):hover {
        background-color: #eee;
      }

      /* ã‚·ãƒ¼ãƒˆã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ */
      .sheet-content {
        display: none;
        padding: 15px;
      }
      .sheet-content.active {
        display: block;
      }

      /* --- ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆ ãƒ†ãƒ¼ãƒ–ãƒ«ã‚¹ã‚¿ã‚¤ãƒ« (è¡Œåˆ—å…¥æ›¿) --- */
      .spreadsheet {
        width: 100%;
        border-collapse: collapse;
        overflow-x: auto;
        display: block;
      }
      .spreadsheet th,
      .spreadsheet td {
        border: 1px solid #d9d9d9;
        padding: 8px 10px;
        min-width: 150px; /* åˆ—ã®æœ€å°å¹… */
        font-size: 13px;
        text-align: right; /* æ•°å€¤ã¯å³å¯„ã› */
      }

      /* ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œ (æ¨ªåˆ—) */
      .spreadsheet thead th {
        text-align: center;
        background-color: #f4f4f4;
        color: #333;
        font-weight: bold;
        position: sticky;
        top: 0;
        z-index: 10;
      }

      /* ãƒ˜ãƒƒãƒ€ãƒ¼åˆ— (ç¸¦åˆ—) */
      .spreadsheet tbody th {
        text-align: left;
        background-color: #f4f4f4;
        color: #333;
        font-weight: bold;
        position: sticky;
        left: 0;
        z-index: 5;
        min-width: 180px; /* é …ç›®åã¯é•·ã‚ */
      }

      /* æŠ•ç¨¿æ–‡ã®è¡Œ */
      .spreadsheet .post-text-row th,
      .spreadsheet .post-text-row td {
        min-height: 150px;
        white-space: pre-wrap;
        word-break: break-all;
        vertical-align: top;
        text-align: left;
      }

      /* --- NEW: æ™‚é–“ã‚°ãƒ«ãƒ¼ãƒ—ã®ãƒ˜ãƒƒãƒ€ãƒ¼ --- */
      .time-header-row th {
        text-align: left;
        background-color: #e8f0fe; /* GSheetã®ãƒ•ãƒªãƒ¼ã‚ºè¡Œã£ã½ã„è‰² */
        color: #1a73e8;
        font-weight: bold;
        font-size: 14px;
        position: sticky;
        left: 0;
        z-index: 6;
      }

      /* --- NEW: ç©ºç™½è¡Œ (åŒºåˆ‡ã‚Šç·š) --- */
      .spacer-row td {
        height: 10px;
        border: none;
        background-color: #fff;
        padding: 5px;
      }

      /* ãƒ—ãƒ¬ãƒŸã‚¢ãƒ æ©Ÿèƒ½ã®è¡Œã‚’è‰²åˆ†ã‘ */
      .premium-row th,
      .premium-row td {
        background-color: #fff8e1;
      }
      .time-header-row.premium-row th {
        background-color: #fff1c6; /* ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ˜ãƒƒãƒ€ãƒ¼ã¯å°‘ã—æ¿ƒã„é»„è‰² */
        color: #b76a00;
      }

      /* ãƒ—ãƒ¬ãƒŸã‚¢ãƒ æ©Ÿèƒ½ï¼šè‡ªå‹•ãƒã‚¤ãƒ©ã‚¤ãƒˆã®è¡¨ç¾ */
      .highlight-blue {
        background-color: #e8f0fe !important;
      } /* 1.5å€ï¼ˆé’ï¼‰ */
      .highlight-yellow {
        background-color: #fff7e0 !important;
      } /* 2.0å€ï¼ˆé»„ï¼‰ */
      .highlight-red {
        background-color: #fce8e6 !important;
      } /* 3.0å€ï¼ˆèµ¤ï¼‰ */

      /* ãƒ¬ãƒãƒ¼ãƒˆã‚„è¨­å®šã‚·ãƒ¼ãƒˆã®ã‚¹ã‚¿ã‚¤ãƒ« (å¤‰æ›´ãªã—) */
      .report-grid,
      .settings-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
      }
      .report-card,
      .settings-card {
        background: #f9f9f9;
        border: 1px solid #e0e0e0;
        border-radius: 8px;
        padding: 20px;
      }
      .report-card h3,
      .settings-card h3 {
        margin-top: 0;
        border-bottom: 2px solid #1a73e8;
        padding-bottom: 8px;
        color: #1a73e8;
      }
      .report-card li {
        font-size: 14px;
        padding: 5px 0;
      }
      .settings-card p {
        font-size: 14px;
      }
      .settings-card input[type='text'] {
        width: 95%;
        padding: 8px;
        border: 1px solid #ccc;
        border-radius: 4px;
        font-family: monospace;
      }
      .settings-card .api-key-note {
        font-size: 12px;
        color: #5f6368;
      }
      .dashboard-kpi {
        font-size: 24px;
        font-weight: bold;
        color: #1a73e8;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- ã‚·ãƒ¼ãƒˆã‚¿ãƒ– (å¤‰æ›´ãªã—) -->
      <div class="sheet-tabs">
        <div class="tab active" onclick="showSheet(event, 'data')">ğŸ“Š ãƒ‡ãƒ¼ã‚¿ (ãƒ¡ã‚¤ãƒ³)</div>
        <div class="tab" onclick="showSheet(event, 'dashboard')">ğŸ  ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</div>
        <div class="tab" onclick="showSheet(event, 'report')">ğŸ“ˆ æœˆæ¬¡ãƒ¬ãƒãƒ¼ãƒˆ (ãƒ—ãƒ¬ãƒŸã‚¢ãƒ )</div>
        <div class="tab" onclick="showSheet(event, 'settings')">âš™ï¸ è¨­å®š</div>
      </div>

      <!-- 1. ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ (å¤‰æ›´ãªã—) -->
      <div id="dashboard" class="sheet-content">
        <!-- (å†…å®¹ã¯å¤‰æ›´ãªã—) -->
        <div class="settings-card">
          <h3>ğŸ  ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h3>
          <p>ç¾åœ¨ã®ç·ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼æ•°</p>
          <div class="dashboard-kpi">10,234 äºº</div>
          <hr />
          <p>
            ã“ã®ãƒ„ãƒ¼ãƒ«ã¯ã€Œãƒ‡ãƒ¼ã‚¿ã€ã‚·ãƒ¼ãƒˆã«Threadsã®æŠ•ç¨¿ãƒ‡ãƒ¼ã‚¿ã‚’è‡ªå‹•ã§è¨˜éŒ²ã—ã¾ã™ã€‚<br />
            ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ç‰ˆã«ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã™ã‚‹ã¨ã€ã€Œæœˆæ¬¡ãƒ¬ãƒãƒ¼ãƒˆã€ã‚„ã€Œè‡ªå‹•ãƒã‚¤ãƒ©ã‚¤ãƒˆã€æ©Ÿèƒ½ãŒæœ‰åŠ¹ã«ãªã‚Šã¾ã™ã€‚
          </p>
        </div>
      </div>

      <!-- 2. ãƒ‡ãƒ¼ã‚¿ï¼ˆãƒ¡ã‚¤ãƒ³ï¼‰ã‚·ãƒ¼ãƒˆ (å¤‰æ›´ã‚ã‚Š) -->
      <div id="data" class="sheet-content active">
        <p style="font-size: 12px; color: #555">
          â€» æŠ•ç¨¿12æ™‚é–“å¾Œã«ã€Œç„¡æ–™ç‰ˆãƒ‡ãƒ¼ã‚¿ã€ãŒè‡ªå‹•è¨˜éŒ²ã•ã‚Œã¾ã™ã€‚<br />
          â€»
          ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ç‰ˆã§ã¯ã€ã€Œæ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã€ãŒè‡ªå‹•æ›´æ–°ã•ã‚Œã€å¹³å‡å€¤ã‚’è¶…ãˆãŸã‚»ãƒ«ãŒè‡ªå‹•ã§è‰²ä»˜ã‘ã•ã‚Œã¾ã™ã€‚
        </p>
        <div style="width: 100%; overflow-x: auto">
          <table class="spreadsheet">
            <thead>
              <tr>
                <th>é …ç›® / æŠ•ç¨¿æ—¥æ™‚</th>
                <!-- æŠ•ç¨¿ã‚’å¤ã„é †ï¼ˆå·¦ï¼‰ã‹ã‚‰ä¸¦ã¹ã‚‹ -->
                <th>11/10<br />12:00</th>
                <th>11/11<br />20:00</th>
                <th>11/12<br />18:30</th>
                <!-- ä»¥ä¸‹ã€æŠ•ç¨¿ãŒè‡ªå‹•ã§æ¨ªã«è¿½åŠ ã•ã‚Œã‚‹ -->
              </tr>
            </thead>
            <tbody>
              <!-- å…±é€šãƒ‡ãƒ¼ã‚¿ -->
              <tr class="post-text-row">
                <th>æŠ•ç¨¿æ–‡</th>
                <td>
                  æ–°ã—ã„PCã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å®Œäº†ï¼<br />ã“ã‚Œã§å‹•ç”»ç·¨é›†ã‚‚å¿«é©ã«ãªã‚Šãã†ã€‚[ç”»åƒã‚ã‚Š]
                </td>
                <td>ä»Šæ—¥ã¯ä¸€æ—¥ä¸­ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã§ã—ãŸã€‚<br />ç–²ã‚ŒãŸ... #GAS #é–‹ç™º</td>
                <td>
                  ã€é€Ÿå ±ã€‘Threadsåˆ†æãƒ„ãƒ¼ãƒ«ã€ã¤ã„ã«å®Œæˆï¼<br />ã“ã‚Œã•ãˆã‚ã‚Œã°åˆ†æãŒæ—ã‚‹ã¯ãšã€‚<br />#Threads
                  #åˆ†æ
                </td>
              </tr>
              <tr>
                <th>æ–‡å­—æ•°</th>
                <td>50</td>
                <td>35</td>
                <td>75</td>
              </tr>
              <tr>
                <th>ã‚¿ã‚¤ãƒ—</th>
                <td>ç”»åƒ</td>
                <td>ãƒ†ã‚­ã‚¹ãƒˆ</td>
                <td>ãƒ†ã‚­ã‚¹ãƒˆ</td>
              </tr>

              <!-- NEW: 12æ™‚é–“å¾Œ (ç„¡æ–™ç‰ˆ) ãƒ˜ãƒƒãƒ€ãƒ¼ -->
              <tr class="time-header-row">
                <th colspan="4">ã€12æ™‚é–“å¾Œã€‘(ç„¡æ–™ç‰ˆ)</th>
              </tr>
              <tr>
                <th>ã‚¤ãƒ³ãƒ—(12h)</th>
                <td class="highlight-blue">1,600</td>
                <!-- 1.5å€è¶…ãˆ (é’) -->
                <td>850</td>
                <td class="highlight-red">3,500</td>
                <!-- 3.0å€è¶…ãˆ (èµ¤) -->
              </tr>
              <tr>
                <th>ã„ã„ã­(12h)</th>
                <td class="highlight-blue">120</td>
                <!-- 1.5å€è¶…ãˆ (é’) -->
                <td>45</td>
                <td class="highlight-yellow">210</td>
                <!-- 2.0å€è¶…ãˆ (é»„) -->
              </tr>
              <tr>
                <th>å†æŠ•ç¨¿/å¼•ç”¨(12h)</th>
                <td>8</td>
                <td>2</td>
                <td>15</td>
              </tr>
              <tr>
                <th>ãƒªãƒ—ãƒ©ã‚¤(12h)</th>
                <td>10</td>
                <td>5</td>
                <td>25</td>
              </tr>
              <tr>
                <th>Engç·æ•°(12h)</th>
                <td>138</td>
                <td>52</td>
                <td>250</td>
              </tr>
              <tr>
                <th>Engç‡(12h)</th>
                <td>8.63%</td>
                <td>6.12%</td>
                <td>7.14%</td>
              </tr>
              <tr>
                <th>ç·ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼(12h)</th>
                <td>10,234</td>
                <td>10,240</td>
                <td>10,255</td>
              </tr>

              <!-- NEW: 24æ™‚é–“å¾Œ (ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ) ãƒ˜ãƒƒãƒ€ãƒ¼ -->
              <tr class="spacer-row">
                <td colspan="4"></td>
              </tr>
              <tr class="time-header-row premium-row">
                <th colspan="4">ã€24æ™‚é–“å¾Œã€‘(ãƒ—ãƒ¬ãƒŸã‚¢ãƒ )</th>
              </tr>
              <tr class="premium-row">
                <th>ã‚¤ãƒ³ãƒ—(24h)</th>
                <td>2,200</td>
                <td>860</td>
                <td>4,200</td>
              </tr>
              <tr class="premium-row">
                <th>ã„ã„ã­(24h)</th>
                <td>130</td>
                <td>46</td>
                <td>220</td>
              </tr>
              <tr class="premium-row">
                <th>å†æŠ•ç¨¿/å¼•ç”¨(24h)</th>
                <td>10</td>
                <td>2</td>
                <td>16</td>
              </tr>
              <tr class="premium-row">
                <th>ãƒªãƒ—ãƒ©ã‚¤(24h)</th>
                <td>12</td>
                <td>5</td>
                <td>26</td>
              </tr>
              <tr class="premium-row">
                <th>Engç·æ•°(24h)</th>
                <td>152</td>
                <td>53</td>
                <td>262</td>
              </tr>
              <tr class="premium-row">
                <th>Engç‡(24h)</th>
                <td>6.91%</td>
                <td>6.16%</td>
                <td>6.24%</td>
              </tr>

              <!-- NEW: 72æ™‚é–“å¾Œ (ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ) ãƒ˜ãƒƒãƒ€ãƒ¼ -->
              <tr class="spacer-row">
                <td colspan="4"></td>
              </tr>
              <tr class="time-header-row premium-row">
                <th colspan="4">ã€72æ™‚é–“å¾Œã€‘(ãƒ—ãƒ¬ãƒŸã‚¢ãƒ )</th>
              </tr>
              <tr class="premium-row">
                <th>ã‚¤ãƒ³ãƒ—(72h)</th>
                <td>2,500</td>
                <td>860</td>
                <td>4,500</td>
              </tr>
              <tr class="premium-row">
                <th>ã„ã„ã­(72h)</th>
                <td>135</td>
                <td>46</td>
                <td>230</td>
              </tr>
              <tr class="premium-row">
                <th>å†æŠ•ç¨¿/å¼•ç”¨(72h)</th>
                <td>10</td>
                <td>2</td>
                <td>17</td>
              </tr>
              <tr class="premium-row">
                <th>ãƒªãƒ—ãƒ©ã‚¤(72h)</th>
                <td>13</td>
                <td>5</td>
                <td>27</td>
              </tr>
              <tr class="premium-row">
                <th>Engç·æ•°(72h)</th>
                <td>158</td>
                <td>53</td>
                <td>274</td>
              </tr>
              <tr class="premium-row">
                <th>Engç‡(72h)</th>
                <td>6.32%</td>
                <td>6.16%</td>
                <td>6.09%</td>
              </tr>

              <!-- NEW: 7æ—¥å¾Œ (ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ) ãƒ˜ãƒƒãƒ€ãƒ¼ -->
              <tr class="spacer-row">
                <td colspan="4"></td>
              </tr>
              <tr class="time-header-row premium-row">
                <th colspan="4">ã€7æ—¥å¾Œã€‘(ãƒ—ãƒ¬ãƒŸã‚¢ãƒ )</th>
              </tr>
              <tr class="premium-row">
                <th>ã‚¤ãƒ³ãƒ—(7d)</th>
                <td>2,600</td>
                <td>860</td>
                <td>4,550</td>
              </tr>
              <tr class="premium-row">
                <th>ã„ã„ã­(7d)</th>
                <td>138</td>
                <td>46</td>
                <td>232</td>
              </tr>
              <tr class="premium-row">
                <th>å†æŠ•ç¨¿/å¼•ç”¨(7d)</th>
                <td>10</td>
                <td>2</td>
                <td>17</td>
              </tr>
              <tr class="premium-row">
                <th>ãƒªãƒ—ãƒ©ã‚¤(7d)</th>
                <td>13</td>
                <td>5</td>
                <td>27</td>
              </tr>
              <tr class="premium-row">
                <th>Engç·æ•°(7d)</th>
                <td>161</td>
                <td>53</td>
                <td>276</td>
              </tr>
              <tr class="premium-row">
                <th>Engç‡(7d)</th>
                <td>6.19%</td>
                <td>6.16%</td>
                <td>6.07%</td>
              </tr>

              <!-- NEW: å…±é€šãƒ‡ãƒ¼ã‚¿ (æœ€å¾Œ) -->
              <tr class="spacer-row">
                <td colspan="4"></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- 3. æœˆæ¬¡ãƒ¬ãƒãƒ¼ãƒˆï¼ˆãƒ—ãƒ¬ãƒŸã‚¢ãƒ ï¼‰ (å¤‰æ›´ãªã—) -->
      <div id="report" class="sheet-content">
        <!-- (å†…å®¹ã¯å¤‰æ›´ãªã—) -->
        <div class="report-grid">
          <div class="report-card">
            <h3>ğŸ“ˆ 2025å¹´11æœˆ ã‚µãƒãƒªãƒ¼</h3>
            <ul>
              <li>1ãƒ¶æœˆã®ç·æŠ•ç¨¿æ•°: 50 ä»¶</li>
              <li>1ãƒ¶æœˆã®ç·ã‚¤ãƒ³ãƒ—ãƒ¬ãƒƒã‚·ãƒ§ãƒ³æ•°: 150,000</li>
              <li>å¹³å‡Engç‡ (12h): 7.2%</li>
            </ul>
          </div>
          <div class="report-card">
            <h3>ğŸ† åå¿œãŒè‰¯ã‹ã£ãŸæŠ•ç¨¿ ãƒ™ã‚¹ãƒˆ10 (ã‚¤ãƒ³ãƒ—é †)</h3>
            <ol>
              <li><a href="#">ã€é€Ÿå ±ã€‘Threadsåˆ†æãƒ„ãƒ¼ãƒ«ã€ã¤ã„ã«å®Œæˆï¼ (3,500)</a></li>
              <li><a href="#">ï¼ˆæŠ•ç¨¿ã‚¿ã‚¤ãƒˆãƒ«...ï¼‰ (2,800)</a></li>
              <li><a href="#">ï¼ˆæŠ•ç¨¿ã‚¿ã‚¤ãƒˆãƒ«...ï¼‰ (2,200)</a></li>
              <!-- ... -->
            </ol>
          </div>
          <div class="report-card">
            <h3>ğŸ”‘ åå¿œãŒè‰¯ã‹ã£ãŸã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰é›†</h3>
            <p>ï¼ˆã“ã‚Œã‚‰ã®å˜èªãŒå«ã¾ã‚Œã‚‹æŠ•ç¨¿ã¯ã€å¹³å‡ã‚ˆã‚ŠEngç‡ãŒé«˜ã„å‚¾å‘ã«ã‚ã‚Šã¾ã™ï¼‰</p>
            <ol>
              <li>åˆ†æ (+3.5%)</li>
              <li>é€Ÿå ± (+2.1%)</li>
              <li>GAS (+1.8%)</li>
              <!-- ... -->
            </ol>
          </div>
        </div>
      </div>

      <!-- 4. è¨­å®šã‚·ãƒ¼ãƒˆ (å¤‰æ›´ãªã—) -->
      <div id="settings" class="sheet-content">
        <!-- (å†…å®¹ã¯å¤‰æ›´ãªã—) -->
        <div class="settings-grid">
          <div class="settings-card">
            <h3>âš™ï¸ åŸºæœ¬è¨­å®š</h3>
            <div id="api-key-section">
              <p>Threads API ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³</p>
              <div id="api-key-status" style="margin-bottom: 10px">
                <span id="api-key-indicator" style="color: #666">èª­ã¿è¾¼ã¿ä¸­...</span>
              </div>
              <div id="api-key-form" style="display: none">
                <input
                  type="password"
                  id="api-key-input"
                  placeholder="APIã‚­ãƒ¼ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"
                  style="width: 300px; margin-right: 10px"
                />
                <button
                  onclick="saveApiKey()"
                  style="
                    background: #1976d2;
                    color: white;
                    border: none;
                    padding: 8px 16px;
                    border-radius: 4px;
                    cursor: pointer;
                  "
                >
                  ä¿å­˜
                </button>
              </div>
              <div id="api-key-actions" style="margin-top: 10px">
                <button
                  id="edit-api-key-btn"
                  onclick="showApiKeyForm()"
                  style="
                    background: #f57c00;
                    color: white;
                    border: none;
                    padding: 6px 12px;
                    border-radius: 4px;
                    cursor: pointer;
                    margin-right: 10px;
                  "
                >
                  ç·¨é›†
                </button>
                <button
                  id="delete-api-key-btn"
                  onclick="deleteApiKey()"
                  style="
                    background: #d32f2f;
                    color: white;
                    border: none;
                    padding: 6px 12px;
                    border-radius: 4px;
                    cursor: pointer;
                  "
                >
                  å‰Šé™¤
                </button>
              </div>
              <p class="api-key-note" style="font-size: 12px; color: #666; margin-top: 10px">
                â€»APIã‚­ãƒ¼ã¯å®‰å…¨ã«æš—å·åŒ–ã•ã‚Œã¦ä¿å­˜ã•ã‚Œã¾ã™<br />
                â€»ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã«å¾“ã„ã”è‡ªèº«ã§å–å¾—ã—ãŸAPIã‚­ãƒ¼ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
              </p>
            </div>
          </div>

          <div class="settings-card">
            <h3>ğŸ§ª ãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ†ã‚¹ãƒˆ</h3>
            <div id="api-test-section">
              <p>Threads APIã‹ã‚‰å®Ÿéš›ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¦ãƒ†ãƒ¼ãƒ–ãƒ«ã«åæ˜ ã—ã¾ã™</p>
              <div id="test-controls" style="margin: 15px 0">
                <button
                  id="test-api-btn"
                  onclick="testThreadsApi()"
                  style="
                    background: #1976d2;
                    color: white;
                    border: none;
                    padding: 10px 20px;
                    border-radius: 4px;
                    cursor: pointer;
                    margin-right: 10px;
                  "
                >
                  ğŸ“Š ãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ†ã‚¹ãƒˆ
                </button>
                <button
                  id="refresh-data-btn"
                  onclick="refreshTableData()"
                  style="
                    background: #388e3c;
                    color: white;
                    border: none;
                    padding: 10px 20px;
                    border-radius: 4px;
                    cursor: pointer;
                  "
                >
                  ğŸ”„ ãƒ†ãƒ¼ãƒ–ãƒ«æ›´æ–°
                </button>
              </div>
              <div
                id="test-status"
                style="margin: 10px 0; padding: 10px; border-radius: 4px; display: none"
              >
                <span id="test-message">å¾…æ©Ÿä¸­...</span>
              </div>
              <div id="test-results" style="margin-top: 15px; display: none">
                <h4>å–å¾—ãƒ‡ãƒ¼ã‚¿ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼:</h4>
                <pre
                  id="test-data"
                  style="
                    background: #f5f5f5;
                    padding: 10px;
                    border-radius: 4px;
                    font-size: 12px;
                    max-height: 200px;
                    overflow-y: auto;
                  "
                ></pre>
              </div>
              <div id="debug-log" style="margin-top: 15px">
                <h4>ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°:</h4>
                <div
                  id="log-container"
                  style="
                    background: #f9f9f9;
                    border: 1px solid #ddd;
                    padding: 10px;
                    border-radius: 4px;
                    max-height: 300px;
                    overflow-y: auto;
                    font-family: monospace;
                    font-size: 11px;
                  "
                >
                  <div class="log-entry">ã‚·ã‚¹ãƒ†ãƒ æº–å‚™å®Œäº†</div>
                </div>
                <button
                  onclick="clearDebugLog()"
                  style="
                    margin-top: 5px;
                    background: #666;
                    color: white;
                    border: none;
                    padding: 4px 8px;
                    border-radius: 2px;
                    font-size: 11px;
                  "
                >
                  ãƒ­ã‚°ã‚¯ãƒªã‚¢
                </button>
              </div>
            </div>
          </div>
          <div class="report-card">
            <h3>ğŸ¨ è‡ªå‹•ãƒã‚¤ãƒ©ã‚¤ãƒˆè¨­å®š (ãƒ—ãƒ¬ãƒŸã‚¢ãƒ )</h3>
            <p>å½“æœˆã®å¹³å‡å€¤ã¨æ¯”è¼ƒã—ã¦ã€æŒ‡å®šå€ç‡ã‚’è¶…ãˆãŸã‚‰è‰²ã‚’å¤‰æ›´ã—ã¾ã™ã€‚</p>
            <ul>
              <li>
                <input type="number" value="1.5" style="width: 50px" /> å€ã‚’è¶…ãˆãŸã‚‰ â†’
                <span style="background: #e8f0fe; padding: 3px 8px">é’è‰²</span>
              </li>
              <li>
                <input type="number" value="2.0" style="width: 50px" /> å€ã‚’è¶…ãˆãŸã‚‰ â†’
                <span style="background: #fff7e0; padding: 3px 8px">é»„è‰²</span>
              </li>
              <li>
                <input type="number" value="3.0" style="width: 50px" /> å€ã‚’è¶…ãˆãŸã‚‰ â†’
                <span style="background: #fce8e6; padding: 3px 8px">èµ¤è‰²</span>
              </li>
            </ul>
            <p style="font-size: 12px">
              ï¼ˆâ€»ã“ã®UIã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã™ã€‚å®Ÿéš›ã®ãƒ„ãƒ¼ãƒ«ã§ã¯è¨­å®šã‚·ãƒ¼ãƒˆä¸Šã®ã‚»ãƒ«ã§ç®¡ç†ã—ã¾ã™ï¼‰
            </p>
          </div>
        </div>
      </div>
    </div>

    <script>
      // ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆç”¨ã®ã‚·ãƒ³ãƒ—ãƒ«ãªã‚¹ã‚¯ãƒªãƒ—ãƒˆ
      function showSheet(e, sheetId) {
        // ã™ã¹ã¦ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’éè¡¨ç¤ºã«
        var contents = document.getElementsByClassName('sheet-content');
        for (var i = 0; i < contents.length; i++) {
          contents[i].classList.remove('active');
        }
        // ã™ã¹ã¦ã®ã‚¿ãƒ–ã‚’éã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«
        var tabs = document.getElementsByClassName('tab');
        for (var i = 0; i < tabs.length; i++) {
          tabs[i].classList.remove('active');
        }
        // é¸æŠã•ã‚ŒãŸã‚‚ã®ã‚’è¡¨ç¤º
        document.getElementById(sheetId).classList.add('active');
        e.currentTarget.classList.add('active');
      }

      // APIã‚­ãƒ¼ç®¡ç†æ©Ÿèƒ½
      function checkApiKeyStatus() {
        google.script.run
          .withSuccessHandler(function (hasKey) {
            var indicator = document.getElementById('api-key-indicator');
            var editBtn = document.getElementById('edit-api-key-btn');
            var deleteBtn = document.getElementById('delete-api-key-btn');

            if (hasKey) {
              indicator.textContent = 'âœ… APIã‚­ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã™';
              indicator.style.color = '#2e7d32';
              editBtn.style.display = 'inline-block';
              deleteBtn.style.display = 'inline-block';
            } else {
              indicator.textContent = 'âŒ APIã‚­ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“';
              indicator.style.color = '#d32f2f';
              editBtn.style.display = 'inline-block';
              deleteBtn.style.display = 'none';
              showApiKeyForm(); // æœªè¨­å®šã®å ´åˆã¯å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ã‚’è¡¨ç¤º
            }
          })
          .withFailureHandler(function (error) {
            console.error('APIã‚­ãƒ¼çŠ¶æ…‹ç¢ºèªã‚¨ãƒ©ãƒ¼:', error);
            document.getElementById('api-key-indicator').textContent = 'ã‚¨ãƒ©ãƒ¼: ' + error.message;
          })
          .hasApiKey();
      }

      function showApiKeyForm() {
        document.getElementById('api-key-form').style.display = 'block';
        document.getElementById('api-key-input').focus();
      }

      function hideApiKeyForm() {
        document.getElementById('api-key-form').style.display = 'none';
        document.getElementById('api-key-input').value = '';
      }

      function saveApiKey() {
        var apiKey = document.getElementById('api-key-input').value.trim();
        addDebugLog('ğŸ”‘ APIã‚­ãƒ¼ä¿å­˜é–‹å§‹', 'info');

        if (!apiKey) {
          alert('APIã‚­ãƒ¼ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
          addDebugLog('âŒ APIã‚­ãƒ¼ãŒç©ºã§ã™', 'error');
          return;
        }

        addDebugLog('APIã‚­ãƒ¼é•·: ' + apiKey.length + 'æ–‡å­—', 'info');

        google.script.run
          .withSuccessHandler(function (result) {
            addDebugLog(
              'APIã‚­ãƒ¼ä¿å­˜çµæœ: ' + JSON.stringify(result),
              result.success ? 'success' : 'error'
            );

            if (result.success) {
              alert(result.message);
              hideApiKeyForm();
              checkApiKeyStatus();
              addDebugLog('âœ… APIã‚­ãƒ¼ä¿å­˜æˆåŠŸ', 'success');
            } else {
              alert('ã‚¨ãƒ©ãƒ¼: ' + result.message);
              addDebugLog('âŒ APIã‚­ãƒ¼ä¿å­˜å¤±æ•—: ' + result.message, 'error');
            }
          })
          .withFailureHandler(function (error) {
            console.error('APIã‚­ãƒ¼ä¿å­˜ã‚¨ãƒ©ãƒ¼:', error);
            addDebugLog('âŒ APIã‚­ãƒ¼ä¿å­˜ä¾‹å¤–: ' + error.message, 'error');
            alert('APIã‚­ãƒ¼ã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message);
          })
          .saveApiKey(apiKey);
      }

      function deleteApiKey() {
        if (!confirm('APIã‚­ãƒ¼ã‚’å‰Šé™¤ã—ã¦ã‚‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ')) {
          return;
        }

        google.script.run
          .withSuccessHandler(function (result) {
            if (result.success) {
              alert(result.message);
              checkApiKeyStatus();
            } else {
              alert('ã‚¨ãƒ©ãƒ¼: ' + result.message);
            }
          })
          .withFailureHandler(function (error) {
            console.error('APIã‚­ãƒ¼å‰Šé™¤ã‚¨ãƒ©ãƒ¼:', error);
            alert('APIã‚­ãƒ¼ã®å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message);
          })
          .deleteApiKey();
      }

      // ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°æ©Ÿèƒ½
      function addDebugLog(message, type) {
        type = type || 'info';
        var timestamp = new Date().toLocaleTimeString();
        var logContainer = document.getElementById('log-container');
        var logEntry = document.createElement('div');
        logEntry.className = 'log-entry';

        var color = '#333';
        if (type === 'error') color = '#d32f2f';
        if (type === 'success') color = '#2e7d32';
        if (type === 'warning') color = '#f57c00';

        logEntry.innerHTML =
          '<span style="color: #666;">[' +
          timestamp +
          ']</span> <span style="color: ' +
          color +
          ';">' +
          message +
          '</span>';
        logContainer.appendChild(logEntry);
        logContainer.scrollTop = logContainer.scrollHeight;
      }

      function clearDebugLog() {
        var logContainer = document.getElementById('log-container');
        logContainer.innerHTML = '<div class="log-entry">ãƒ­ã‚°ã‚¯ãƒªã‚¢å®Œäº†</div>';
      }

      // APIãƒ†ã‚¹ãƒˆæ©Ÿèƒ½
      function testThreadsApi() {
        addDebugLog('ğŸ”„ APIãƒ†ã‚¹ãƒˆé–‹å§‹', 'info');
        showTestStatus('loading', 'ğŸ”„ APIã‚­ãƒ¼ã‚’ç¢ºèªä¸­...');

        google.script.run
          .withSuccessHandler(function (hasKey) {
            addDebugLog(
              'APIã‚­ãƒ¼ç¢ºèªçµæœ: ' + (hasKey ? 'è¨­å®šæ¸ˆã¿' : 'æœªè¨­å®š'),
              hasKey ? 'success' : 'warning'
            );

            if (!hasKey) {
              showTestStatus(
                'error',
                'âŒ APIã‚­ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚ã¾ãšAPIã‚­ãƒ¼ã‚’è¨­å®šã—ã¦ãã ã•ã„ã€‚'
              );
              addDebugLog('âŒ APIã‚­ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“', 'error');
              return;
            }

            showTestStatus('loading', 'ğŸ“¡ Threads APIã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ä¸­...');
            addDebugLog('ğŸ“¡ Threads APIå‘¼ã³å‡ºã—é–‹å§‹', 'info');

            google.script.run
              .withSuccessHandler(function (result) {
                addDebugLog(
                  'APIå‘¼ã³å‡ºã—å®Œäº†: ' + JSON.stringify(result, null, 2),
                  result.success ? 'success' : 'error'
                );

                if (result.success) {
                  showTestStatus('success', 'âœ… ãƒ‡ãƒ¼ã‚¿å–å¾—æˆåŠŸï¼');
                  showTestResults(result.data);
                  addDebugLog(
                    'âœ… ãƒ‡ãƒ¼ã‚¿å–å¾—æˆåŠŸ - ãƒ¦ãƒ¼ã‚¶ãƒ¼: ' +
                      (result.data.user ? result.data.user.username : 'N/A'),
                    'success'
                  );
                } else {
                  showTestStatus('error', 'âŒ ã‚¨ãƒ©ãƒ¼: ' + result.message);
                  addDebugLog('âŒ API ã‚¨ãƒ©ãƒ¼: ' + result.message, 'error');
                }
              })
              .withFailureHandler(function (error) {
                console.error('API ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼:', error);
                addDebugLog('âŒ APIå‘¼ã³å‡ºã—å¤±æ•—: ' + error.message, 'error');
                showTestStatus('error', 'âŒ APIå‘¼ã³å‡ºã—ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message);
              })
              .testThreadsApiConnection();
          })
          .withFailureHandler(function (error) {
            console.error('APIã‚­ãƒ¼ç¢ºèªã‚¨ãƒ©ãƒ¼:', error);
            addDebugLog('âŒ APIã‚­ãƒ¼ç¢ºèªå¤±æ•—: ' + error.message, 'error');
            showTestStatus('error', 'âŒ APIã‚­ãƒ¼ç¢ºèªã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message);
          })
          .hasApiKey();
      }

      function refreshTableData() {
        showTestStatus('loading', 'ğŸ”„ ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–°ä¸­...');

        google.script.run
          .withSuccessHandler(function (result) {
            if (result.success) {
              showTestStatus('success', 'âœ… ãƒ†ãƒ¼ãƒ–ãƒ«æ›´æ–°å®Œäº†ï¼');
              updateDataTable(result.data);
            } else {
              showTestStatus('error', 'âŒ ã‚¨ãƒ©ãƒ¼: ' + result.message);
            }
          })
          .withFailureHandler(function (error) {
            console.error('ãƒ†ãƒ¼ãƒ–ãƒ«æ›´æ–°ã‚¨ãƒ©ãƒ¼:', error);
            showTestStatus('error', 'âŒ ãƒ†ãƒ¼ãƒ–ãƒ«æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message);
          })
          .fetchAndUpdateTableData();
      }

      function showTestStatus(type, message) {
        var statusDiv = document.getElementById('test-status');
        var messageSpan = document.getElementById('test-message');

        statusDiv.style.display = 'block';
        messageSpan.textContent = message;

        // ã‚¹ã‚¿ã‚¤ãƒ«è¨­å®š
        statusDiv.className = '';
        if (type === 'loading') {
          statusDiv.style.background = '#e3f2fd';
          statusDiv.style.color = '#1976d2';
          statusDiv.style.border = '1px solid #bbdefb';
        } else if (type === 'success') {
          statusDiv.style.background = '#e8f5e8';
          statusDiv.style.color = '#2e7d32';
          statusDiv.style.border = '1px solid #c8e6c9';
        } else if (type === 'error') {
          statusDiv.style.background = '#ffebee';
          statusDiv.style.color = '#c62828';
          statusDiv.style.border = '1px solid #ffcdd2';
        }
      }

      function showTestResults(data) {
        var resultsDiv = document.getElementById('test-results');
        var dataPreElement = document.getElementById('test-data');

        resultsDiv.style.display = 'block';
        dataPreElement.textContent = JSON.stringify(data, null, 2);
      }

      function updateDataTable(data) {
        // ãƒ‡ãƒ¼ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«ã®æ›´æ–°ãƒ­ã‚¸ãƒƒã‚¯
        // å®Ÿéš›ã®ãƒ†ãƒ¼ãƒ–ãƒ«è¦ç´ ã‚’æ›´æ–°
        if (data && data.posts && data.posts.length > 0) {
          // æœ€æ–°3ä»¶ã®æŠ•ç¨¿ã§ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æ›´æ–°
          var posts = data.posts.slice(0, 3);

          // æŠ•ç¨¿æ–‡ã®æ›´æ–°
          var postTextCells = document.querySelectorAll('.post-text-row td');
          posts.forEach(function (post, index) {
            if (postTextCells[index]) {
              postTextCells[index].innerHTML =
                post.text.substring(0, 100) + (post.text.length > 100 ? '...' : '');
            }
          });

          // ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®æ›´æ–°
          updateMetricRow(
            'ã‚¤ãƒ³ãƒ—(12h)',
            posts.map(p => p.insights.views || 0)
          );
          updateMetricRow(
            'ã„ã„ã­(12h)',
            posts.map(p => p.insights.likes || 0)
          );
          updateMetricRow(
            'å†æŠ•ç¨¿/å¼•ç”¨(12h)',
            posts.map(p => (p.insights.reposts || 0) + (p.insights.quotes || 0))
          );
          updateMetricRow(
            'ãƒªãƒ—ãƒ©ã‚¤(12h)',
            posts.map(p => p.insights.replies || 0)
          );
          updateMetricRow(
            'Engç·æ•°(12h)',
            posts.map(p => p.insights.totalEngagement || 0)
          );
          updateMetricRow(
            'Engç‡(12h)',
            posts.map(p => p.insights.engagementRate + '%' || '0%')
          );
        }
      }

      function updateMetricRow(metricName, values) {
        var rows = document.querySelectorAll('tr');
        for (var i = 0; i < rows.length; i++) {
          var firstCell = rows[i].querySelector('th');
          if (firstCell && firstCell.textContent.trim() === metricName) {
            var dataCells = rows[i].querySelectorAll('td');
            values.forEach(function (value, index) {
              if (dataCells[index]) {
                dataCells[index].textContent = value;
              }
            });
            break;
          }
        }
      }

      // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«APIã‚­ãƒ¼çŠ¶æ…‹ã‚’ç¢ºèª
      window.onload = function () {
        checkApiKeyStatus();
      };
    </script>
  </body>
</html>
